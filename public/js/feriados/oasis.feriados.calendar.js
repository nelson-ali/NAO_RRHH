function iniciarCalendarioLaboralConFeriados(a,e,n,o){var t=new Date,i=(t.getDate(),t.getMonth(),t.getFullYear(),3);i=parseInt(i);var d=[],r=($(".calendar-events"),"prev,next"),s="year",c=!0,l=!0,p=!0,u=!0;switch(p=l=c=!1,i){case 1:case 2:u=!1,!5}return $("#calendar").fullCalendar({header:{left:r,center:"title",right:s},year:e,month:n,date:o,firstDay:1,weekends:u,editable:c,droppable:l,selectable:p,weekNumbers:!0,weekNumberTitle:"#Semana",timeFormat:"H(:mm)",events:[],viewRender:function(a){switch(renderAnnotations(a,"sdnfdsjanfkjsan"),a.name){case"month":d=[];var r=0,e=["mon","tue","wed","thu","fri","sat","sun"],i="",s="",c=0;$.each(e,function(a,e){r=0,$("td.fc-"+e).map(function(a,e){r++;var n=$(this).data("date"),o=$(this).data("date");if(null!=n){var t=n.split("-");switch(n=t[2]+"-"+t[1]+"-"+t[0],c=t[0],r){case 1:""==i&&(i=n),d.push({semana:1,fecha:n});break;case 2:d.push({semana:2,fecha:n});break;case 3:d.push({semana:3,fecha:n});break;case 4:d.push({semana:4,fecha:n});break;case 5:d.push({semana:5,fecha:n});break;case 6:s=n,d.push({semana:6,fecha:n})}o<$.fullCalendar.formatDate(new Date,"yyyy-MM-dd")&&$(this).css("background-color","silver")}})});var l=obtenerFeriadosRangoFechas(0,0,c,i,s);$.each(e,function(a,e){r=0,$("td.fc-"+e).map(function(a,e){r++;var n=$(this).data("date"),o="",t="",i=$(this);$.each(l,function(a,e){o=e.fecha_ini,t=e.fecha_fin;if(n<=t&&o<=n){i.css("background-color","orange");$(".fc-day-content");i.append("<b>"+e.feriado+"</b>"),i.css("background-color","orange"),i.append("<br>"+e.descripcion)}})})})}}}),d}function fechaConvertirAFormato(a,e){""==e&&(e="-");var n=a,o=n.getDate(),t=n.getMonth(),i="",r="";return o<10&&(i="0"),(t+=1)<10&&(r="0"),i+o+e+r+t+e+n.getFullYear()}function obtenerFeriadosRangoFechas(a,e,n,o,t){var i=[];return 0<n&&""!=o&&""!=t&&$.ajax({url:"/feriados/listrange",type:"POST",datatype:"json",async:!1,cache:!1,data:{dia:a,mes:e,gestion:n,fecha_ini:o,fecha_fin:t},success:function(a){var e=jQuery.parseJSON(a);0<e.length&&$.each(e,function(a,e){i.push({id:e.id,feriado:e.feriado,descripcion:e.descripcion,cantidad_dias:e.cantidad_dias,repetitivo:e.repetitivo,dia:e.dia,mes:e.mes,gestion:e.gestion,fecha_ini:e.fecha_ini,fecha_fin:e.fecha_fin,observacion:e.observacion})})}}),i}function cargarModalHorario(a){return 0<a&&($.ajax({url:"/horarioslaborales/getone",type:"POST",datatype:"json",async:!1,cache:!1,data:{id:a},success:function(a){var e=jQuery.parseJSON(a);0<e.length&&$.each(e,function(a,e){$("#txtNombreHorario").val(e.nombre),$("#txtNombreAlternativoHorario").val(e.nombre_alternativo),$("#txtColorHorario").val(e.color),$("#txtColorHorario").css({"background-color":e.color,color:e.color}),$("#txtHoraEntHorario").val(e.hora_entrada),$("#txtHoraSalHorario").val(e.hora_salida),$("#txtHoraInicioRangoEnt").val(e.hora_inicio_rango_ent),$("#txtHoraFinalizacionRangoEnt").val(e.hora_final_rango_ent),$("#txtHoraInicioRangoSal").val(e.hora_inicio_rango_sal),$("#txtHoraFinalizacionRangoSal").val(e.hora_final_rango_sal),1===e.agrupador?$("#chkPermitirCruce").prop("checked",!0):$("#chkPermitirCruce").prop("checked",!1),$("#txtObservacion").val(e.observacion);var n=e.hora_entrada,o=e.hora_salida;""==n&&(n="00:00:00"),""==o&&(o="00:00:00"),$("#txtHorasLaborales").val(e.horas_laborales)})}}),!0)}function obtenerDatosHorario(a){var n=[];return 0<a&&$.ajax({url:"/horarioslaborales/getone",type:"POST",datatype:"json",async:!1,cache:!1,data:{id:a},success:function(a){var e=jQuery.parseJSON(a);0<e.length&&$.each(e,function(a,e){n.push({nombre:e.nombre,nombre_alternativo:e.nombre_alternativo,color:e.color,hora_entrada:e.hora_entrada,hora_salida:e.hora_salida,hora_inicio_rango_ent:e.hora_inicio_rango_ent,hora_final_rango_ent:e.hora_final_rango_ent,hora_inicio_rango_sal:e.hora_inicio_rango_sal,observacion:e.observacion,horas_laborales:e.horas_laborales,dias_laborales:e.dias_laborales})})}}),n}function agregarColumnaSumaTotales(a){$(".fc-border-separate tr:first").append("<th style='width: 87px;' id='thColumnaTotales' class='thColumnaTotales'> Hrs Semana </th>");var n=0;$(".fc-border-separate tr.fc-week").each(function(a,e){n++,$(this).append("<td id='tdSumaSemana"+n+"' class='tdSumaSemana fc-last'><div style='min-height: 67px;align-content: center;'><div id='divSumaSemana"+n+"' class='fc-day-suma-horas-semana'><span id='spSumaSemana"+n+"' class='spSumaSemana'>100</span></div></div></td>")});var e=a+1;$(".fc-border-separate tr:last").after("<tr id=''><td style='text-align: right;' colspan='"+e+"' class=''><b>Promedio semanal de horas (3 Semanas marcadas):</b></td><td id='tdSumaPromedioTresSemanas' class='tdSumaPromedioTresSemanas fc-first fc-day fc-last'><div style='min-height: 67px;align-content: center;'><div id='divSumaPromedioTresSemanas' class='fc-suma-promedio-horas-3-semanas'><span id='spSumaPromedioTresSemanas'>0</span></div></div></td></tr>")}function removerColumnaSumaTotales(){$("#thColumnaTotales").remove(),$("#tdSumaSemana1").remove(),$("#tdSumaSemana2").remove(),$("#tdSumaSemana3").remove(),$("#tdSumaSemana4").remove(),$("#tdSumaSemana5").remove(),$("#tdSumaSemana6").remove(),$("#trSumaPromedioTresSemanas").remove()}function numeroHoras(a){if(""==a)return 0;var e=a.split(":"),n=parseFloat(e[0]),o=parseFloat(e[1]),t=parseFloat(e[2]),i=0,r=0;return 0<t&&(i=t/60),0<(o+=i)&&(r=o/60),n+=r}function cargarUbicacionesPrincipalesRegistradasParaPerfil(a){$("#lstUbicacionesPrincipales").html(""),$("#lstUbicacionesPrincipales").append("<option value='0' data-cant-nodos-hijos='-1'>Seleccionar...</option>"),$("#lstUbicacionesPrincipales").prop("disabled","disabled");0<a&&$.ajax({url:"/ubicaciones/listubicacionespricipalesporperfil/",type:"POST",datatype:"json",async:!1,cache:!1,data:{id_perfillaboral:a},success:function(a){var e=jQuery.parseJSON(a);0<e.length?($("#lstUbicacionesPrincipales").prop("disabled",!1),$("#divUbicacionesPrincipales").show(),$.each(e,function(a,e){$("#lstUbicacionesPrincipales").append("<option value='"+e.id_ubicacion+"'  data-cant-nodos-hijos='"+e.cant_nodos_hijos+"'>"+e.ubicacion+"</option>")})):($("#lstUbicacionesPrincipales").prop("disabled","disabled"),$("#divUbicacionesPrincipales").hide(),$("#divEstacionesAsignadas").hide())}})}function cargarEstacionesRegistradasPorUbicacionParaPerfil(a,e){$("#lstEstacionesAsignadas").html(""),$("#lstEstacionesAsignadas").append("<option value='0'>Seleccionar...</option>"),$("#lstEstacionesAsignadas").prop("disabled",!0);var n=0;0<a&&0<e&&$.ajax({url:"/ubicaciones/listestacionesporubicacionparaperfil/",type:"POST",datatype:"json",async:!1,cache:!1,data:{id_perfillaboral:a,id_ubicacion:e},success:function(a){var e=jQuery.parseJSON(a);$("#divEstacionesAsignadas").show(),0<e.length&&($("#lstEstacionesAsignadas").prop("disabled",!1),$.each(e,function(a,e){0<e.id_estacion&&(n=1,$("#lstEstacionesAsignadas").append("<option value='"+e.id_estacion+"'>"+e.estacion+"</option>"))}),0==n&&$("#divEstacionesAsignadas").hide())}})}function obtenerUltimoDiaMes(a){return a=$.ajax({url:"/perfileslaborales/getultimafechames/",type:"POST",datatype:"json",async:!1,cache:!1,data:{fecha:a},success:function(a){}}).responseText}function obtenerFechaMasDias(a,e){return a=$.ajax({url:"/perfileslaborales/getfechamasdias/",type:"POST",datatype:"json",async:!1,cache:!1,data:{fecha:a,dias:e},success:function(a){}}).responseText}function procesaTextoAFecha(a,e){var n=a.split(e);return(a=new Date(n[1]+"/"+n[0]+"/"+n[2])).getTime()}function renderAnnotations(a,e){var n=$(a.element).find(".fc-agenda-slots").parent();0===n.find("#annotationSegmentContainer").length?annotationSegmentContainer=$("<div style='position:absolute;z-index:-1;top:0;left:0' id='annotationSegmentContainer'>").prependTo(n):annotationSegmentContainer=n.find("#annotationSegmentContainer");for(var o="",t=0;t<e.length;t++){var i=e[t];if(i.start>=a.start&&i.end<=a.end){var r=a.timePosition(i.start,i.start),s=a.timePosition(i.end,i.end)-r,c=$.fullCalendar.dayDiff(i.start,a.visStart),l=a.colContentLeft(c)-2,d=a.colContentRight(c)+3-l,p="";i.cls&&(p=" "+i.cls);var u="";i.color&&(u="color:"+i.color+";"),i.background&&(u+="background:"+i.background+";"),o+='<div style="position: absolute; top: '+r+"px; left: "+l+"px; width: "+d+"px; height: "+s+"px;"+u+'" class="fc-annotation fc-annotation-skin'+p+'">'+(i.title||"")+"</div>"}}annotationSegmentContainer.html(o)}