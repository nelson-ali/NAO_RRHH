function exportarReporteControlMarcaciones(e,o,n,r){columna=new Object,filtros=new Object,agrupados=new Object,ordenados=new Object,nombres=$("#divGridControlMarcaciones").jqxGrid("getcolumn","nombres"),ci=$("#divGridControlMarcaciones").jqxGrid("getcolumn","ci"),expd=$("#divGridControlMarcaciones").jqxGrid("getcolumn","expd"),gestion=$("#divGridControlMarcaciones").jqxGrid("getcolumn","gestion"),mes_nombre=$("#divGridControlMarcaciones").jqxGrid("getcolumn","mes_nombre"),fecha=$("#divGridControlMarcaciones").jqxGrid("getcolumn","fecha"),hora=$("#divGridControlMarcaciones").jqxGrid("getcolumn","hora"),maquina=$("#divGridControlMarcaciones").jqxGrid("getcolumn","maquina"),usuario=$("#divGridControlMarcaciones").jqxGrid("getcolumn","usuario"),fecha_ini_rango=$("#divGridControlMarcaciones").jqxGrid("getcolumn","fecha_ini_rango"),fecha_fin_rango=$("#divGridControlMarcaciones").jqxGrid("getcolumn","fecha_fin_rango"),observacion=$("#divGridControlMarcaciones").jqxGrid("getcolumn","observacion"),columna[nombres.datafield]={text:nombres.text,hidden:nombres.hidden},columna[ci.datafield]={text:ci.text,hidden:ci.hidden},columna[expd.datafield]={text:expd.text,hidden:expd.hidden},columna[gestion.datafield]={text:gestion.text,hidden:gestion.hidden},columna[mes_nombre.datafield]={text:mes_nombre.text,hidden:mes_nombre.hidden},columna[fecha.datafield]={text:fecha.text,hidden:fecha.hidden},columna[hora.datafield]={text:hora.text,hidden:hora.hidden},columna[maquina.datafield]={text:maquina.text,hidden:maquina.hidden},columna[usuario.datafield]={text:usuario.text,hidden:usuario.hidden},columna[fecha_ini_rango.datafield]={text:fecha_ini_rango.text,hidden:fecha_ini_rango.hidden},columna[fecha_fin_rango.datafield]={text:fecha_fin_rango.text,hidden:fecha_fin_rango.hidden},columna[observacion.datafield]={text:observacion.text,hidden:observacion.hidden};var a=$("#divGridControlMarcaciones").jqxGrid("groups");null!=a&&""!=a||(a="null");var i=$("#divGridControlMarcaciones").jqxGrid("getsortinformation");if(null!=i.sortcolumn){var t=i.sortcolumn,d=i.sortdirection;ordenados[t]={asc:d.ascending,desc:d.descending}}else ordenados="";for(var c=$("#divGridControlMarcaciones").jqxGrid("getrows"),l=$("#divGridControlMarcaciones").jqxGrid("getfilterinformation"),s=0,f=0;f<l.length;f++)for(var u=l[f],m=u.filter.getfilters(),h=0;h<m.length;h++){0<h&&s++,filtros[f+s]={columna:u.filtercolumn,valor:m[h].value,condicion:m[h].condition,tipo:m[h].type}}var g=c.length,x=JSON.stringify(filtros),v=JSON.stringify(columna),_=JSON.stringify(ordenados);v=btoa(utf8_encode(v)),x=btoa(utf8_encode(x)),_=btoa(utf8_encode(_));var G=btoa(utf8_encode(a));v=v.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),x=x.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),G=G.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),_=_.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"");var p="";switch(e){case 1:p="/marcaciones/exportcontrolmarcacionexcel/";break;case 2:p="/marcaciones/exportcontrolmarcacionpdf/";break;case 3:p="/marcaciones/exportcontrolmarcaciontodoexcel/"}""!=p&&window.open(p+o+"/"+n+"/"+r+"/"+g+"/"+v+"/"+x+"/"+G+"/"+_,"_blank")}function utf8_encode(e){if(null==e)return"";var o,n,r,a=e+"",i="";o=n=0,r=a.length;for(var t=0;t<r;t++){var d=a.charCodeAt(t),c=null;if(d<128)n++;else if(127<d&&d<2048)c=String.fromCharCode(d>>6|192,63&d|128);else if(55296!=(63488&d))c=String.fromCharCode(d>>12|224,d>>6&63|128,63&d|128);else{if(55296!=(64512&d))throw new RangeError("Unmatched trail surrogate at "+t);var l=a.charCodeAt(++t);if(56320!=(64512&l))throw new RangeError("Unmatched lead surrogate at "+(t-1));d=((1023&d)<<10)+(1023&l)+65536,c=String.fromCharCode(d>>18|240,d>>12&63|128,d>>6&63|128,63&d|128)}null!==c&&(o<n&&(i+=a.slice(o,n)),i+=c,o=n=t+1)}return o<n&&(i+=a.slice(o,r)),i}