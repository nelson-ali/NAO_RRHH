function definirGrillaParaListaControlExcepcionesPorIdRelaboralPersona(s){var p=s.id_relaboral,r=s.genero,t={datatype:"json",datafields:[{name:"nro_row",type:"integer"},{name:"id",type:"integer"},{name:"id_persona",type:"integer"},{name:"fecha_ini",type:"date"},{name:"hora_ini",type:"string"},{name:"fecha_fin",type:"date"},{name:"hora_fin",type:"string"},{name:"justificacion",type:"string"},{name:"destino",type:"string"},{name:"turno",type:"integer"},{name:"turno_descripcion",type:"string"},{name:"entrada_salida",type:"integer"},{name:"entrada_salida_descripcion",type:"string"},{name:"controlexcepcion_observacion",type:"string"},{name:"controlexcepcion_estado",type:"string"},{name:"controlexcepcion_estado_descripcion",type:"string"},{name:"controlexcepcion_user_reg_id",type:"numeric"},{name:"controlexcepcion_user_registrador",type:"string"},{name:"controlexcepcion_fecha_reg",type:"date"},{name:"controlexcepcion_user_ver_id",type:"numeric"},{name:"controlexcepcion_user_verificador",type:"string"},{name:"controlexcepcion_fecha_ver",type:"date"},{name:"controlexcepcion_user_apr_id",type:"numeric"},{name:"controlexcepcion_user_aprobador",type:"string"},{name:"controlexcepcion_fecha_apr",type:"date"},{name:"controlexcepcion_user_mod_id",type:"numeric"},{name:"controlexcepcion_user_modificador",type:"string"},{name:"controlexcepcion_fecha_mod",type:"date"},{name:"excepcion_id",type:"integer"},{name:"excepcion",type:"string"},{name:"tipoexcepcion_id",type:"integer"},{name:"tipo_excepcion",type:"string"},{name:"genero_id",type:"integer"},{name:"genero",type:"string"},{name:"cantidad",type:"numeric"},{name:"unidad",type:"string"},{name:"fraccionamiento",type:"string"},{name:"frecuencia_descripcion",type:"string"},{name:"compensatoria",type:"integer"},{name:"compensatoria_descripcion",type:"string"},{name:"redondeo",type:"integer"},{name:"redondeo_descripcion",type:"string"},{name:"horario",type:"integer"},{name:"horario_descripcion",type:"string"},{name:"refrigerio",type:"integer"},{name:"refrigerio_descripcion",type:"string"},{name:"lugar",type:"integer"},{name:"lugar_descripcion",type:"string"},{name:"codigo",type:"string"},{name:"color",type:"string"},{name:"controlexcepcion_observacion",type:"string"},{name:"estado",type:"string"},{name:"estado_descripcion",type:"string"},{name:"agrupador",type:"integer"},{name:"boleta",type:"integer"},{name:"boleta_descripcion",type:"string"}],url:"/misboletasexcepciones/listporrelaboral?id="+p,cache:!1,root:"Rows",beforeprocessing:function(e){t.totalrecords=e[0].TotalRows},filter:function(){$("#divGridControlExcepciones").jqxGrid("updatebounddata","filter")},sort:function(){$("#divGridControlExcepciones").jqxGrid("updatebounddata","sort")}},n=new $.jqx.dataAdapter(t);!function(){prepareSimulator("grid");var e=obtenerFiltrablesPorRelaboral(p),t=e.excepciones,i=[];$.each(t,function(e,t){t=(t=(t=t.replace("#",",")).replace("#",",")).replace("#",","),i.push(t)});var o=e.codigos;$("#divGridControlExcepciones").jqxGrid({width:"99.9%",height:500,source:n,sortable:!0,altRows:!0,groupable:!0,columnsresize:!0,pageable:!0,pagerMode:"advanced",pagesize:10,virtualmode:!0,rendergridrows:function(e){return e.data},showfilterrow:!0,filterable:!0,showtoolbar:!0,autorowheight:!0,enablebrowserselection:!0,rendertoolbar:function(e){var t=$("<div></div>");e.append(t),t.append("<button title='Registrar nueva boleta de permiso' id='addcontrolexceptrowbutton' class='btn btn-sm btn-success' type='button'><i class='fa fa-plus-square fa-lg text-info' title='Nuevo Registro.'/></i> Nuevo</button>"),t.append("<button title='Modificar registro de control de excepci&oacute;n.' id='updateexceptrowbutton'  class='btn btn-sm btn-default' type='button' ><i class='fa fa-pencil-square fa-lg text-success' title='Modificar registro.'/> Modificar</button>"),t.append("<button title='Enviar registro de control de excepci&oacute;n.' id='sendexceptrowbutton'  class='btn btn-sm btn-default' type='button' ><i class='gi gi-send fa-lg text-warning' title='Enviar Solicitud'></i> Enviar</button>"),t.append("<button title='Imprimir formulario de control de excepci&oacute;n.' id='printexceptrowbutton' class='btn btn-sm btn-default' type='button'><i class='fa fa-print fa-lg text-primary' title='Imprimir Control de Excepci&oacute;n.'/></i> Imprimir</button>"),t.append("<button title='Dar de baja registro de control de excepci&oacute;n.' id='deleteexceptrowbutton' class='btn btn-sm btn-default' type='button'><i class='fa fa-times-circle-o fa-lg text-danger' title='Dar de baja al registro.'/></i> Eliminar</button>"),t.append("<button title='Ver calendario de turnos y permisos de manera global para la persona.' id='turnexceptrowbutton' class='btn btn-sm btn-default' type='button'><i class='fa fa-calendar fa-lg text-purple' title='Vista Turnos Laborales por Perfil.'/></i> Ver</button>"),t.append("<button title='Refrescar Grilla' id='refreshbutton' class='btn btn-sm btn-default' type='button'><i class='fa fa-repeat fa-lg text-default' title='Refrescar grilla.'/></i> Actualizar</button>"),t.append("<button title='Desagrupar.' id='cleargroupsrowbutton' class='btn btn-sm btn-default' type='button'><i class='fa fa-chain-broken fa-lg text-default' title='Desagrupar.'/></i> Desagrupar</button>"),t.append("<button title='Desfiltrar.' id='clearfiltersrowbutton' class='btn btn-sm btn-default' type='button'><i class='gi gi-sorting fa-lg text-default' title='Desfiltrar.'/></i> Desfiltrar</button>");$("#hdnIntermediacion").val(-1),$("#hdnIdRelDestPrincipal").val(0),$("#hdnIdRelDestSecundario").val(0),$("#hdnIdControlExcepcionEnvio").val(0),$("#hdnIdControlExcepcionEdit").val(0),$("#hdnIdRelaboralNew").val(0),$("#hdnIdRelaboralEdit").val(0),$("#lblObservacionNew").text("Observaciones:"),$("#lblObservacionEdit").text("Observaciones:"),$("#txtObservacionNew").prop("placeholder","Observaciones..."),$("#txtObservacionEdit").prop("placeholder","Observaciones..."),$("#refreshbutton").off(),$("#refreshbutton").on("click",function(){$("#divGridControlExcepciones").jqxGrid("updatebounddata")}),$("#cleargroupsrowbutton").off(),$("#cleargroupsrowbutton").on("click",function(){$("#divGridControlExcepciones").jqxGrid("cleargroups")}),$("#clearfiltersrowbutton").off(),$("#clearfiltersrowbutton").on("click",function(){$("#divGridControlExcepciones").jqxGrid("clearfilters")}),$("#addcontrolexceptrowbutton").off(),$("#addcontrolexceptrowbutton").on("click",function(){$("#divTabControlExcepciones").jqxTabs("enableAt",1),$("#divTabControlExcepciones").jqxTabs("disableAt",2),$("#divTabControlExcepciones").jqxTabs("disableAt",3),$("#divTabControlExcepciones").jqxTabs("disableAt",4),$("#divTabControlExcepciones").jqxTabs({selectedItem:1}),inicializarMiFormularioControlExcepcionesNuevoEditar(1,p,0,"","","","","","",0,-1,r,""),$("#hdnIdRelaboralNew").val(p),$("#lstExcepcionesNew").focus()}),$("#updateexceptrowbutton").off(),$("#updateexceptrowbutton").on("click",function(){var e=$("#divGridControlExcepciones").jqxGrid("getselectedrowindex");if(0<=e){var t=$("#divGridControlExcepciones").jqxGrid("getrowdata",e);if(null!=t)if($("#hdnIdControlExcepcionEdit").val(t.id),1==t.controlexcepcion_estado||2==t.controlexcepcion_estado)if(1==t.boleta)$("#divTabControlExcepciones").jqxTabs("enableAt",0),$("#divTabControlExcepciones").jqxTabs("disableAt",1),$("#divTabControlExcepciones").jqxTabs("disableAt",2),$("#divTabControlExcepciones").jqxTabs("disableAt",3),$("#divTabControlExcepciones").jqxTabs("disableAt",4),$("#divTabControlExcepciones").jqxTabs("enableAt",2),$("#divTabControlExcepciones").jqxTabs({selectedItem:2}),$("#hdnIdRelaboralEdit").val(p),$("#hdnIdControlExcepcionEdit").val(t.id),limpiarMensajesErrorPorValidacionControlExcepcion(2),inicializarMiFormularioControlExcepcionesNuevoEditar(2,p,t.excepcion_id,t.fecha_ini,t.hora_ini,t.fecha_fin,t.hora_fin,t.justificacion,t.destino,t.turno,t.entrada_salida,r,t.controlexcepcion_observacion);else{var i="Usted no tiene los permisos suficientes para modificar este tipo de excepciones. Consulte con Personal de Control de Personal o el Administrador.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}else{var i="Debe seleccionar un registro en estado EN ELABORACI&Oacute;N necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}else{var i="Debe seleccionar un registro necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}),$("#sendexceptrowbutton").off(),$("#sendexceptrowbutton").on("click",function(){var e=$("#divGridControlExcepciones").jqxGrid("getselectedrowindex");if(0<=e){var t=$("#divGridControlExcepciones").jqxGrid("getrowdata",e);if(null!=t)if(1==t.controlexcepcion_estado||2==t.controlexcepcion_estado||-3==t.controlexcepcion_estado||-4==t.controlexcepcion_estado)if(1==t.boleta){var i=fechaConvertirAFormato(t.fecha_ini,"-"),o=controlaValidezPlazoDeSolicitudBoleta(p,i);if(o){var r=horaEsMayorAhora(t.hora_ini,t.hora_fin);if(1==r){var n="Debe modificar la hora de finalizaci&oacute;n debido a inconsistencia.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(n),$("#divMsjeNotificacionError").jqxNotification("open")}else{var a=fechaConvertirAFormato(t.fecha_ini,"-"),c=fechaConvertirAFormato(t.fecha_fin,"-"),l=verificaFrecuenciaMiBoleta(t.id,p,t.excepcion_id,a,t.hora_ini,c,t.hora_fin,t.horario);if(l){$("#divTabControlExcepciones").jqxTabs("enableAt",0),$("#divTabControlExcepciones").jqxTabs("disableAt",1),$("#divTabControlExcepciones").jqxTabs("disableAt",2),$("#divTabControlExcepciones").jqxTabs("enableAt",3),$("#divTabControlExcepciones").jqxTabs("disableAt",4),$("#divTabControlExcepciones").jqxTabs({selectedItem:3});var d=0;5===t.controlexcepcion_estado&&(d=1),cargarDatosDestinatariosFormulario(s,t,d)}}}}else{var n="Usted no tiene los permisos suficientes para modificar este tipo de excepciones. Consulte con Personal de Control de Personal o el Administrador.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(n),$("#divMsjeNotificacionError").jqxNotification("open")}else{var n="Debe seleccionar un registro con estado EN ELABORACI&Oacute;N, ELABORADO o estar en espera de reenvio debido ERROR EN LA SOLICITUD para posibilitar la aprobaci&oacute;n del registro";$("#divMsjePorError").html(""),$("#divMsjePorError").append(n),$("#divMsjeNotificacionError").jqxNotification("open")}}else{var n="Debe seleccionar un registro necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(n),$("#divMsjeNotificacionError").jqxNotification("open")}}),$("#printexceptrowbutton").off(),$("#printexceptrowbutton").on("click",function(){var e=$("#divGridControlExcepciones").jqxGrid("getselectedrowindex");if(0<=e){var t=$("#divGridControlExcepciones").jqxGrid("getrowdata",e);if(null!=t)if(1<=t.controlexcepcion_estado||t.controlexcepcion_estado<0)if(1==t.boleta)exportarFormulario(t.id);else{var i="Usted no tiene los permisos suficientes para modificar este tipo de excepciones. Consulte con Personal de Control de Personal o el Administrador.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}else{var i="El formulario no puede ser visible en este estado "+t.controlexcepcion_estado_descripcion+".";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}else{var i="Debe seleccionar un registro necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}),$("#deleteexceptrowbutton").off(),$("#deleteexceptrowbutton").on("click",function(){var e=$("#divGridControlExcepciones").jqxGrid("getselectedrowindex");if(0<=e){var t=$("#divGridControlExcepciones").jqxGrid("getrowdata",e);if(null!=t)if(1==t.controlexcepcion_estado||2==t.controlexcepcion_estado){if(confirm("¿Esta seguro de dar de baja registro de control de excepción?"))if(1==t.boleta)darDeBajaControlExcepcion(t.id);else{var i="Usted no tiene los permisos suficientes para modificar este tipo de excepciones. Consulte con Personal de Control de Personal o el Administrador.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}else{var i="Para dar de baja un registro, este debe estar en estado ELABORADO o en ELABORACI&Oacute;N necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}else{var i="Debe seleccionar un registro necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}),$("#turnexceptrowbutton").off(),$("#turnexceptrowbutton").on("click",function(){$("#divTabControlExcepciones").jqxTabs("enableAt",0),$("#divTabControlExcepciones").jqxTabs("disableAt",1),$("#divTabControlExcepciones").jqxTabs("disableAt",2),$("#divTabControlExcepciones").jqxTabs("disableAt",3),$("#divTabControlExcepciones").jqxTabs("enableAt",4),$("#divTabControlExcepciones").jqxTabs({selectedItem:4});$("#spanPrefijoCalendarioLaboral").html(""),$("#spanSufijoCalendarioLaboral").html(" Vrs. Calendario de Excepciones (Individual)");var e=new Date,t=e.getDate(),i=e.getMonth(),o=e.getFullYear(),r=$("#divGridControlExcepciones").jqxGrid("getselectedrowindex");if(0<=r){var n=$("#divGridControlExcepciones").jqxGrid("getrowdata",r);if(null!=n){var a=fechaConvertirAFormato(n.fecha_ini,"-"),c=a.split("-");t=c[0],i=c[1]-1,o=c[2]}}$("#calendar").html("");var l=iniciarCalendarioLaboralPorRelaboralTurnosAndExcepcionesParaVerMisAsignacionesPersonales(s,p,5,0,3,[],o,i,t);sumarTotalHorasPorSemana(l)})},columns:[{text:"Nro.",filterable:!1,columntype:"number",width:40,cellsalign:"center",align:"center",pinned:!0,cellsrenderer:rownumberrenderer},{text:"Estado",filtertype:"checkedlist",datafield:"controlexcepcion_estado_descripcion",filteritems:["EN ELABORACION","ELABORADO","VERIFICACION SOLICITADA","APROBACION SOLICITADA","VERIFICADO","APROBADO","RECEPCIONADO","VERIFICACION RECHAZADA","ERROR SOLICITUD DE VERIFICACION","APROBADO","ERROR SOLICITUD APROBACION"],width:90,cellsalign:"center",align:"center",pinned:!0,hidden:!1,cellclassname:cellclass},{text:"Tipo Excepci&oacute;n",filtertype:"checkedlist",filteritems:["PERMISO PARTICULAR","LICENCIA","COMISI&Oacute;N","CONSULTA M&Eacute;DICA","OTROS"],datafield:"tipo_excepcion",width:100,cellsalign:"center",align:"center",pinned:!0,hidden:!1},{text:"Excepci&oacute;n",filtertype:"checkedlist",filteritems:i,datafield:"excepcion",width:150,cellsalign:"justify",align:"center",pinned:!0,hidden:!1},{text:"C&oacute;digo",filtertype:"checkedlist",filteritems:o,datafield:"codigo",width:80,align:"center",cellsalign:"center",pinned:!0,hidden:!1},{text:"Fecha Inicio",datafield:"fecha_ini",filtertype:"range",width:80,cellsalign:"center",cellsformat:"dd-MM-yyyy",align:"center",pinned:!0,hidden:!1},{text:"Hora Inicio",filtertype:"checkedlist",datafield:"hora_ini",width:80,cellsalign:"center",align:"center",pinned:!0,hidden:!1},{text:"Fecha Fin",datafield:"fecha_fin",filtertype:"range",width:80,cellsalign:"center",cellsformat:"dd-MM-yyyy",align:"center",pinned:!0,hidden:!1},{text:"Hora Fin",filtertype:"checkedlist",datafield:"hora_fin",width:80,cellsalign:"center",align:"center",pinned:!0,hidden:!1},{text:"Motivo",datafield:"justificacion",columntype:"textbox",filtertype:"input",width:100,cellsalign:"justify",align:"center",hidden:!1},{text:"Lugar",datafield:"destino",columntype:"textbox",filtertype:"input",width:100,cellsalign:"justify",align:"center",hidden:!1},{text:"Color",datafield:"color",columntype:"textbox",filtertype:"input",width:80,cellsalign:"center",align:"center",hidden:!1,cellsrenderer:cellsrenderer},{text:"G&eacute;nero",filtertype:"checkedlist",filteritems:["INDISTINTO","FEMENINO","MASCULINO"],datafield:"genero",width:100,align:"center",cellsalign:"center",hidden:!1},{text:"Frecuencia",columntype:"textbox",filtertype:"input",datafield:"frecuencia_descripcion",width:80,align:"center",cellsalign:"center",hidden:!1},{text:"Compensar Horas",filtertype:"checkedlist",filteritems:["SI","NO"],datafield:"compensatoria_descripcion",width:100,align:"center",cellsalign:"center",hidden:!1},{text:"Contr. Horario",filtertype:"checkedlist",filteritems:["SI","NO"],datafield:"horario_descripcion",width:100,align:"center",cellsalign:"center",hidden:!1},{text:"Refrigerio",filtertype:"checkedlist",filteritems:["SI","NO"],datafield:"refrigerio_descripcion",width:100,align:"center",cellsalign:"center",hidden:!1},{text:"Turno",filtertype:"checkedlist",filteritems:["1°","2°",""],datafield:"turno_descripcion",width:100,align:"center",cellsalign:"center",hidden:!1},{text:"E/S",filtertype:"checkedlist",filteritems:["ENTRADA","SALIDA",""],datafield:"entrada_salida_descripcion",width:100,align:"center",cellsalign:"center",hidden:!1},{text:"Solicitante",columntype:"textbox",filtertype:"input",datafield:"controlexcepcion_user_registrador",width:100,align:"center",cellsalign:"justify",hidden:!1},{text:"Fecha Sol.",filtertype:"range",datafield:"controlexcepcion_fecha_reg",width:100,align:"center",cellsformat:"dd-MM-yyyy h:i:s",cellsalign:"center",hidden:!1},{text:"Verificador",columntype:"textbox",filtertype:"input",datafield:"controlexcepcion_user_verificador",width:100,align:"center",cellsalign:"justify",hidden:!1},{text:"Fecha Ver.",filtertype:"range",datafield:"controlexcepcion_fecha_ver",width:100,align:"center",cellsformat:"dd-MM-yyyy",cellsalign:"center",hidden:!1},{text:"Aprobador",columntype:"textbox",filtertype:"input",datafield:"controlexcepcion_user_aprobador",width:100,align:"center",cellsalign:"justify",hidden:!1},{text:"Fecha Apr.",filtertype:"range",datafield:"controlexcepcion_fecha_apr",width:100,align:"center",cellsformat:"dd-MM-yyyy",cellsalign:"center",hidden:!1},{text:"Observacion",columntype:"textbox",filtertype:"input",datafield:"controlexcepcion_observacion",width:100,align:"center",hidden:!1}]})}()}var rownumberrenderer=function(e,t,i,o,r,n){return"<div align='center'>"+(e+1)+"</div>"},cellsrenderer=function(e,t,i,o){var r=$(o);return r.css({"background-color":i}),r[0].outerHTML};function obtenerFiltrablesPorRelaboral(e){var t=null;return $.ajax({url:"/controlexcepciones/getfilters/",type:"POST",datatype:"json",async:!1,cache:!1,data:{id_relaboral:e},success:function(e){t=jQuery.parseJSON(e)},error:function(){alert("Se ha producido un error Inesperado")}}),t}