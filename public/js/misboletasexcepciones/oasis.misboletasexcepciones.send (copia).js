function cargarDatosDestinatariosFormulario(e,i,a){var t=-1;t=0==a?verificaAplicabilidadDeIntermediario(e.departamento_administrativo,e.cargo):2,$("#chkDestinatarioSecundario").prop("checked",!1),$("#divCheckAndDestinatarioSecundario").hide(),$("#hdnIdRelSolicitante").val(e.id_relaboral),$("#hdnIdControlExcepcionEnvio").val(i.id),$("#hdnIntermediacion").val(t);var r="divDestinatarioPrincipal",o="divDestinatarioSecundario";if(0<=t){$("#"+o).html(""),$("#"+o).html(""),$("#divCheckAndDestinatarioSecundario").hide(),$("#hdnAprobacionDirecta").val(0);var n=verificaRequerimientoAprobacionDirecta(e.id_persona,fechaConvertirAFormato(i.fecha_ini),r);if(0==n)if($("#divCheckAndDestinatarioSecundario").show(),0==t||2==t){var c=despliegaWidgetDestinatarioFijo(e.id_relaboral,r),d=0;0<c&&(0<(d=despliegaWidgetDestinatarioFijo(c,o))?$("#divCheckAndDestinatarioSecundario").show():$("#divCheckAndDestinatarioSecundario").hide());var s="<div class='block'><p>Solicitud de Excepci&oacute;n por <b>"+i.excepcion+"</b>.</p></div>";$("#divAsunto").html(s);var l="<div class='block'><p>"+i.justificacion+"</p></div>";$("#divJustificacion").html(l),$("#hdnIdRelDestPrincipal").val(c),$("#hdnIdRelDestSecundario").val(d),$("#txtMensajeAdicional").val(""),$("#txtMensajeAdicional").focus()}else{var p,u,v=despliegaSelectDestinatariosSeleccionables(e.id_departamento_administrativo,e.cargo,0,r);p={localdata:v,datatype:"array"},u=new $.jqx.dataAdapter(p);$("#divDestinatarioPrincipal").html("<div style='border: none;' id='lstBoxDestinatariosPrincipales'></div>"),$("#lstBoxDestinatariosPrincipales").jqxListBox({multiple:!0,checkboxes:!0,filterable:!0,allowDrop:!0,allowDrag:!0,source:u,width:"100%",height:250,displayMember:"nombres",valueMember:"id_relaboral",renderer:function(e,i,a){var t=v[e];if(null!=t){var r="<div class='widget'>";return r+="<div class='widget-simple themed-background-default'>",r+="<a href='page_ready_user_profile.html'>",r+="<img src='"+t.ruta_foto+"' class='widget-image img-circle pull-left'>",r+="</a>",r+="<h4 class='widget-content widget-content-light'>",r+="<a href='#'>",r+="<strong>"+t.nombres+"</strong>",r+="</a>",r+="<small>"+t.cargo+"</small>",r+="</h4>",r+="</div></div>"}}});d=0;d=despliegaWidgetDestinatarioFijo(e.id_relaboral,o);s="<div class='block'><p>Solicitud de Excepci&oacute;n por <b>"+i.excepcion+"</b>.</p></div>";$("#divAsunto").html(s);l="<div class='block'><p>"+i.justificacion+"</p></div>";$("#divJustificacion").html(l),$("#hdnIdRelSolicitante").val(e.id_relaboral),$("#hdnIdControlExcepcionEnvio").val(i.id),$("#hdnIdRelDestPrincipal").val(d),$("#hdnIdRelDestSecundario").val(d),$("#txtMensajeAdicional").val(""),$("#txtMensajeAdicional").focus()}else{c=n,d=0;s="<div class='block'><p>Solicitud de Excepci&oacute;n por <b>"+i.excepcion+"</b>.</p></div>";$("#divAsunto").html(s);l="<div class='block'><p>"+i.justificacion+"</p></div>";$("#divJustificacion").html(l),$("#hdnAprobacionDirecta").val(1),$("#hdnIdRelDestPrincipal").val(c),$("#hdnIdRelDestSecundario").val(d),$("#txtMensajeAdicional").val(""),$("#txtMensajeAdicional").focus()}}else $("#divMsjePorSuccess").append("No se encontr&oacute; el registro de Gerencia Administrativa, verifique nuevemante."),$("#divMsjeNotificacionSuccess").jqxNotification("open"),$("#divGridControlExcepciones").jqxGrid("updatebounddata")}function verificaAplicabilidadDeIntermediario(e,i){var a=0;return $.ajax({url:"/misboletasexcepciones/verificaintemerdiacion/",type:"POST",datatype:"json",data:{departamento_administrativo:e,cargo:i},async:!1,cache:!1,success:function(e){var i=jQuery.parseJSON(e);a=i.result},error:function(){a=-2}}),a}function despliegaWidgetDestinatarioFijo(e,t){var r="",o=0;return $.ajax({url:"/relaborales/getinmediatojefesuperior/",type:"POST",datatype:"json",data:{id_relaboral:e,cantidad:1},async:!1,cache:!1,success:function(e){var i=jQuery.parseJSON(e);if(1==i.length){var a=i[0];r="<div class='widget'>",r+="<div class='widget-simple themed-background-default'>",r+="<a href='page_ready_user_profile.html'>",r+="<img src='"+a.ruta_foto+"' class='widget-image img-circle pull-left'>",r+="</a>",r+="<h4 class='widget-content widget-content-light'>",r+="<a href='#'>",r+="<strong>"+a.nombres+"</strong>",r+="</a>",r+="<small>"+a.cargo+"</small>",r+="</h4>",r+="</div></div>",$("#"+t).html(r),o=a.id_relaboral}}}),o}function verificaRequerimientoAprobacionDirecta(e,i,r){var o=0;return $.ajax({url:"/relaborales/getaprobadordirecto/",type:"POST",datatype:"json",data:{id_persona:e,fecha:i},async:!1,cache:!1,success:function(e){var i=jQuery.parseJSON(e);if(1==i.length){var a=i[0],t="<div class='widget'>";t+="<div class='widget-simple themed-background-default'>",t+="<a href='page_ready_user_profile.html'>",t+="<img src='"+a.ruta_foto+"' class='widget-image img-circle pull-left'>",t+="</a>",t+="<h4 class='widget-content widget-content-light'>",t+="<a href='#'>",t+="<strong>"+a.nombres+"</strong>",t+="</a>",t+="<small>"+a.cargo+"</small>",t+="</h4>",t+="</div></div>",$("#"+r).html(t),o=a.id_relaboral}}}),o}function despliegaSelectDestinatariosSeleccionables(e,i,a,t){var r=[];return $.ajax({url:"/relaborales/getintermediariospordepartamento/",type:"POST",datatype:"json",data:{id_organigrama:e,cargo:i,cantidad:0},async:!1,cache:!1,success:function(e){r=jQuery.parseJSON(e)}}),r}function enviarMensajeSolicitudExcepcion(e,i,a,t,r,o,n){var c=!1;return $.ajax({url:"/misboletasexcepciones/enviomensaje/",type:"POST",datatype:"json",data:{id_rel_solicitante:e,id_rel_dest_principal:i,id_rel_dest_secundario:a,id_controlexcepcion:t,mensaje_adicional:r,operacion:o,copia_destinatario_secundario:n},async:!1,cache:!1,beforeSend:function(){$("#divCarga").show()},complete:function(){$("#divCarga").hide()},success:function(e){var i=jQuery.parseJSON(e);c=i.result,1==i.result?(c=!0,$("#divMsjePorSuccess").html(""),$("#divMsjePorSuccess").append(i.msj),$("#divMsjeNotificacionSuccess").jqxNotification("open"),$("#divGridControlExcepciones").jqxGrid("updatebounddata")):0==i.result?(c=!1,$("#divMsjePorWarning").html(""),$("#divMsjePorWarning").append(i.msj),$("#divMsjeNotificacionWarning").jqxNotification("open"),(4<=i.estado||i.estado<0)&&(c=!0,$("#divGridControlExcepciones").jqxGrid("updatebounddata"))):(c=!1,$("#divMsjePorError").html(""),$("#divMsjePorError").append(i.msj),$("#divMsjeNotificacionError").jqxNotification("open"))}}),c}function controlaPlazoDeSolicitudBoleta(e){var a=!1;return $.ajax({url:"/misboletasexcepciones/vervalideztemporalidadsolicitud/",type:"POST",datatype:"json",data:{id_controlexcepcion:e},async:!1,cache:!1,success:function(e){var i=jQuery.parseJSON(e);1==i.result?a=!0:(a=!1,$("#divMsjePorError").html(""),$("#divMsjePorError").append(i.msj),$("#divMsjeNotificacionError").jqxNotification("open"))}}),a}function controlaValidezPlazoDeSolicitudBoleta(e,i){var a=!1;return $.ajax({url:"/misboletasexcepciones/verificavalideztemporalidadsolicitud/",type:"POST",datatype:"json",data:{id_relaboral:e,fecha:i},async:!1,cache:!1,success:function(e){var i=jQuery.parseJSON(e);1==i.result?a=!0:(a=!1,$("#divMsjePorError").html(""),$("#divMsjePorError").append(i.msj),$("#divMsjeNotificacionError").jqxNotification("open"))}}),a}