function exportarReporteTranspuesto(e,r,a,o){columna=new Object,filtros=new Object,agrupados=new Object,ordenados=new Object,fecha=$("#divGrillaReporte").jqxGrid("getcolumn","fecha"),turno=$("#divGrillaReporte").jqxGrid("getcolumn","turno"),modalidad_marcacion=$("#divGrillaReporte").jqxGrid("getcolumn","modalidad_marcacion"),horario=$("#divGrillaReporte").jqxGrid("getcolumn","horario"),columna[fecha.datafield]={text:fecha.text,hidden:fecha.hidden},columna[turno.datafield]={text:turno.text,hidden:turno.hidden},columna[modalidad_marcacion.datafield]={text:modalidad_marcacion.text,hidden:modalidad_marcacion.hidden},columna[horario.datafield]={text:horario.text,hidden:horario.hidden};var t=$("#divGrillaReporte").jqxGrid("groups");null!=t&&""!=t||(t="null");var i=$("#divGrillaReporte").jqxGrid("getsortinformation");if(null!=i.sortcolumn){var n=i.sortcolumn,d=i.sortdirection;ordenados[n]={asc:d.ascending,desc:d.descending}}else ordenados="";for(var l=$("#divGrillaReporte").jqxGrid("getrows"),c=$("#divGrillaReporte").jqxGrid("getfilterinformation"),s=0,f=0;f<c.length;f++)for(var u=c[f],m=u.filter.getfilters(),g=0;g<m.length;g++){0<g&&s++,filtros[f+s]={columna:u.filtercolumn,valor:m[g].value,condicion:m[g].condition,tipo:m[g].type}}var h=l.length,p=JSON.stringify(filtros),v=JSON.stringify(columna),x=JSON.stringify(ordenados);v=btoa(utf8_encode(v)),p=btoa(utf8_encode(p)),x=btoa(utf8_encode(x));var G=btoa(utf8_encode(t));v=v.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),p=p.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),G=G.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),x=x.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"");var _="";switch(e){case 1:_="/mishorariosymarcaciones/exporttransexcel";break;case 2:_="/mishorariosymarcaciones/exporttranspdf"}""!=_&&window.open(_+"/"+h+"/"+r+"/"+a+"/"+o+"/"+v+"/"+p+"/"+G+"/"+x,"_blank")}function utf8_encode(e){if(null==e)return"";var r,a,o,t=e+"",i="";r=a=0,o=t.length;for(var n=0;n<o;n++){var d=t.charCodeAt(n),l=null;if(d<128)a++;else if(127<d&&d<2048)l=String.fromCharCode(d>>6|192,63&d|128);else if(55296!=(63488&d))l=String.fromCharCode(d>>12|224,d>>6&63|128,63&d|128);else{if(55296!=(64512&d))throw new RangeError("Unmatched trail surrogate at "+n);var c=t.charCodeAt(++n);if(56320!=(64512&c))throw new RangeError("Unmatched lead surrogate at "+(n-1));d=((1023&d)<<10)+(1023&c)+65536,l=String.fromCharCode(d>>18|240,d>>12&63|128,d>>6&63|128,63&d|128)}null!==l&&(r<a&&(i+=t.slice(r,a)),i+=l,r=a=n+1)}return r<a&&(i+=t.slice(r,o)),i}