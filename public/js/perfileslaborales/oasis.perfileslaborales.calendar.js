function iniciarCalendarioLaboral(a,r,e,o,n,i){r=parseInt(r);var m=[],t=7,s=($(".calendar-events"),"prev,next"),l="year,month,agendaWeek,agendaDay",c=!0,d=!0,h=!0,u=!0;switch(a){case 1:case 2:case 3:switch(r){case 1:case 2:break;case 3:s="",l="year"}break;case 4:break;case 5:switch(h=d=c=!1,r){case 1:case 2:break;case 3:s="",l="year"}}switch(r){case 1:case 2:u=!1,!(t=5)}return $("#calendar").fullCalendar({header:{left:s,center:"title",right:l},year:o,month:n,date:i,firstDay:1,weekends:u,editable:c,droppable:d,selectable:h,weekNumbers:!0,weekNumberTitle:"#S",timeFormat:"H(:mm)",drop:function(a,r){var e=$(this).data("eventObject"),o=$.extend({},e);o.start=a,$("#calendar").fullCalendar("renderEvent",o,!0),sumarTotalHorasPorSemana(m)},eventDrop:function(a,r,e,o,n){var i=a.className+"",t=i.split("_");t[1];"b"==(i=t[0])&&n(),sumarTotalHorasPorSemana(m)},eventDrag:function(a,r,e,o,n){var i=a.className+"",t=i.split("_");t[1];"b"==(i=t[0])&&n(),sumarTotalHorasPorSemana(m)},events:e,eventClick:function(i,a,r){var t=i.className+"",e=t.split("_"),o=e[1];t=e[0];var n=0;null!=i.id&&(n=i.id);var s=fechaConvertirAFormato(i.start,"-"),l=s,c=i.start;null!=i.end&&""!=i.end&&(l=fechaConvertirAFormato(i.end,"-"),c=i.end);var d=i.start,h=c,u=c;($("#txtHorarioFechaIni").datepicker("setDate",i.start),$("#txtHorarioFechaFin").datepicker("setDate",c),$("#txtHorarioFechaIni").datepicker("update",s),$("#txtHorarioFechaIni").datepicker({format:"dd-mm-yyyy",default:i.start,weekStart:1,startDate:d,endDate:h,autoclose:!0}).on("changeDate",function(a){(d=new Date(a.date.valueOf())).setDate(d.getDate(new Date(a.date.valueOf()))),$("#txtHorarioFechaFin").datepicker("setStartDate",d)}),$("#txtHorarioFechaFin").datepicker({default:c,weekStart:1,startDate:d,endDate:u,autoclose:!0}).on("changeDate",function(a){(h=new Date(a.date.valueOf())).setDate(h.getDate(new Date(a.date.valueOf()))),$("#txtHorarioFechaIni").datepicker("setEndDate",h)}),$("#txtHorarioFechaFin").datepicker("update",l),0<o)?cargarModalHorario(o)?("b"==t?($("#btnDescartarHorario").hide(),$("#btnGuardarModificacionHorario").hide(),$("#txtHorarioFechaIni").prop("disabled","disabled"),$("#txtHorarioFechaFin").prop("disabled","disabled")):($("#btnGuardarModificacionHorario").show(),$("#btnDescartarHorario").show(),$("#txtHorarioFechaIni").prop("disabled",!1),$("#txtHorarioFechaFin").prop("disabled",!1)),$("#popupDescripcionHorario").modal("show"),$("#btnDescartarHorario").off(),$("#btnDescartarHorario").on("click",function(){switch(t){case"r":case"d":bajaTurnoEnCalendario(n)&&($("#calendar").fullCalendar("removeEvents",i._id),$("#popupDescripcionHorario").modal("hide"));break;case"n":$("#calendar").fullCalendar("removeEvents",i._id),$("#popupDescripcionHorario").modal("hide")}sumarTotalHorasPorSemana(m)}),$("#btnGuardarModificacionHorario").off(),$("#btnGuardarModificacionHorario").on("click",function(){switch(t){case"r":case"n":if(s!=$("#txtHorarioFechaIni").val()||l!=$("#txtHorarioFechaFin").val()){$("#calendar").fullCalendar("removeEvents",i._id),$("#popupDescripcionHorario").modal("hide");var a=$("#txtHorarioFechaIni").val(),r=$("#txtHorarioFechaFin").val(),e=a.split("-"),o=r.split("-");a=e[2]+"-"+e[1]+"-"+e[0],r=o[2]+"-"+o[1]+"-"+o[0];var n=calcularCantidadHorasLaborales(i.hora_entrada,i.hora_salida);addEvent={id:i.id,title:i.title,className:i.className,start:a,end:r,color:i.color,horas_laborales:n,editable:!0,hora_entrada:i.hora_entrada,hora_salida:i.hora_salida,agrupador:i.agrupador},$("#calendar").fullCalendar("renderEvent",addEvent,!0)}$("#popupDescripcionHorario").modal("hide")}sumarTotalHorasPorSemana(m)})):alert("Error al determinar los datos del horario."):alert("El registro corresponde a un periodo de descanso")},eventResize:function(a,r,e,o){var n=a.className+"",i=n.split("_");i[1];"b"==(n=i[0])&&o(),sumarTotalHorasPorSemana(m)},eventRender:function(r,a){var e=r.className+"",o=e.split("_");o[1];"b"!=(e=o[0])&&(a.append("<div align='right'><a class='closeon' style='background: #ffffff' title='Eliminar' href='#'><i title='Eliminar' class='hi hi-remove'></i></a></div>"),a.find(".closeon").click(function(){$("#calendar").fullCalendar("removeEvents",r._id);var a=0;switch(null!=r.id&&(a=r.id),e){case"r":case"d":bajaTurnoEnCalendario(a)}return sumarTotalHorasPorSemana(m),!1}))},viewRender:function(a){if("month"==a.name){removerColumnaSumaTotales(),agregarColumnaSumaTotales(t),m=[];var i=0;$.each(["mon","tue","wed","thu","fri","sat","sun"],function(a,r){i=0,$("td.fc-"+r).map(function(a,r){i++;var e=$(this).data("date"),o=$(this).data("date");if(null!=e){var n=e.split("-");switch(e=n[2]+"-"+n[1]+"-"+n[0],i){case 1:m.push({semana:1,fecha:e});break;case 2:m.push({semana:2,fecha:e});break;case 3:m.push({semana:3,fecha:e});break;case 4:m.push({semana:4,fecha:e});break;case 5:m.push({semana:5,fecha:e});break;case 6:m.push({semana:6,fecha:e})}o<$.fullCalendar.formatDate(new Date,"yyyy-MM-dd")&&$(this).css("background-color","silver")}})}),sumarTotalHorasPorSemana(m)}}}),m}var initEvents=function(){$(".calendar-events").find("li").each(function(){var a=$(this).data("horas_laborales"),r=$(this).data("dias_laborales"),e=$(this).data("hora_entrada"),o=$(this).data("hora_inicio_rango_ent"),n=$(this).data("hora_final_rango_ent"),i=$(this).data("hora_salida"),t=$(this).data("hora_inicio_rango_sal"),s=$(this).data("hora_final_rango_sal"),l=$(this).data("agrupador"),c={className:"n_"+this.id,title:$.trim($(this).text()),color:$(this).css("background-color"),horas_laborales:a,dias_laborales:r,hora_entrada:e,hora_inicio_rango_ent:o,hora_final_rango_ent:n,hora_salida:i,hora_inicio_rango_sal:t,hora_final_rango_sal:s,agrupador:l};$(this).data("eventObject",c),$(this).draggable({zIndex:999,revert:!0,revertDuration:0})})};function obtenerHorariosDisponiblesRango(a,r,e){var o=e+1,_=[],n=new Date,f=(n.getDate(),n.getMonth(),n.getFullYear(),!1);switch(a){case 1:case 2:f=!0}return $.ajax({url:"/horarioslaborales/listdisponiblesrango",type:"POST",datatype:"json",async:!1,cache:!1,data:{gestion:r,mes:o},success:function(a){var r=jQuery.parseJSON(a);0<r.length&&$.each(r,function(a,r){var e=r.fecha_ini.split("-"),o=e[0],n=e[1],i=e[2],t=r.hora_entrada.split(":"),s=t[0],l=t[1],c=(t[2],r.fecha_fin.split("-")),d=c[0],h=c[1],u=c[2],m=r.hora_entrada.split(":"),p=m[0],$=m[1];m[2];_.push({id:r.id_horariolaboral,className:"d_"+r.id_horariolaboral,title:r.nombre,start:new Date(o,n,i,s,l),end:new Date(d,h,u,p,$),allDay:f,color:r.color,horas_laborales:r.horas_laborales,dias_laborales:r.dias_laborales,hora_entrada:r.hora_entrada,hora_inicio_rango_ent:r.hora_inicio_rango_ent,hora_final_rango_ent:r.hora_final_rango_ent,hora_salida:r.hora_salida,hora_inicio_rango_sal:r.hora_inicio_rango_sal,hora_final_rango_sal:r.hora_final_rango_sal,agrupador:r.agrupador})})}}),_}function obtenerHorariosRegistradosEnCalendarioPorPerfil(a,r,S,e,o){var H=[],n=new Date,x=(n.getDate(),n.getMonth(),n.getFullYear(),!1);switch(r){case 1:case 2:x=!0}return $.ajax({url:"/calendariolaboral/listregistered",type:"POST",datatype:"json",async:!1,cache:!1,data:{id:a,fecha_ini:e,fecha_fin:o},success:function(a){var r=jQuery.parseJSON(a);0<r.length&&$.each(r,function(a,r){var e=0,o="00:00:00",n="24:00:00",i="#000000",t="DESCANSO";null!=r.id_horariolaboral?(e=r.id_horariolaboral,t=r.horario_nombre,o=r.hora_entrada.split(":"),n=r.hora_salida.split(":"),i=r.color):(o=o.split(":"),n=n.split(":"));var s=r.calendario_fecha_ini.split("-"),l=s[0],c=s[1]-1,d=s[2],h=o[0],u=o[1],m=(o[2],r.calendario_fecha_fin.split("-")),p=m[0],$=m[1]-1,_=m[2],f=n[0],v=n[1],b=(n[2],"r_");0==e&&(b="d_");var g=i;S?"0"==r.e&&(g="#000000",b="b_"):(g="#000000",b="b_"),H.push({id:r.id_calendariolaboral,className:b+e,title:t,start:new Date(l,c,d,h,u),end:new Date(p,$,_,f,v),allDay:x,color:i,editable:S,borderColor:g,horas_laborales:r.horas_laborales,dias_laborales:r.dias_laborales,hora_entrada:r.hora_entrada,hora_inicio_rango_ent:r.hora_inicio_rango_ent,hora_final_rango_ent:r.hora_final_rango_ent,hora_salida:r.hora_salida,hora_inicio_rango_sal:r.hora_inicio_rango_sal,hora_final_rango_sal:r.hora_final_rango_sal,agrupador:r.horario_agrupador,agrupador_descripcion:r.horario_agrupador_descripcion})})}}),H}function cargarHorariosDisponibles(a){$("#ulHorariosEnEspera").html(""),0<a.length&&$.each(a,function(a,r){var e=r.id,o=r.color,n=r.title,i=$(".calendar-events"),t=r.horas_laborales,s=r.dias_laborales,l=r.hora_entrada,c=r.hora_inicio_rango_ent,d=r.hora_final_rango_ent,h=r.hora_salida,u=r.hora_inicio_rango_sal,m=r.hora_final_rango_sal,p=r.agrupador;i.append('<li style="font-weight:bold;color:#ffffff;display: block;list-style: none; background-color: '+o+'" class="ui-draggable '+r.class+'" id="'+e+'" data-horas_laborales="'+t+'" data-dias_laborales="'+s+'" data-hora_entrada="'+l+'" data-hora_inicio_rango_ent="'+c+'" data-hora_final_rango_ent="'+d+'" data-hora_salida="'+h+'" data-hora_final_rango_sal="'+m+'" data-hora_inicio_rango_sal="'+u+'" data-agrupador="'+p+'">'+$("<div />").text(n).html()+"</li>"),initEvents()})}function validaFormularioHorario(){var a=!0,r="";$(".msjs-alert").hide(),limpiarMensajesErrorPorValidacionHorario();var e=null,o=$("#txtNombreHorario").val(),n=($("#txtNombreAlternativoHorario").val(),$("#txtColorHorario").val()),i=$("#txtHoraEntHorario").val(),t=$("#txtHoraSalHorario").val(),s=$("#txtMinutosToleranciaAcu").val(),l=$("#txtMinutosToleranciaEnt").val(),c=$("#txtMinutosToleranciaSal").val(),d=$("#txtHoraInicioRangoEnt").val(),h=$("#txtHoraFinalizacionRangoEnt").val(),u=$("#txtHoraInicioRangoSal").val(),m=$("#txtHoraFinalizacionRangoSal").val();if(""==o){a=!1;r="Debe introducir un nombre para el horario necesariamente.";$("#divNombreHorario").addClass("has-error"),$("#helpErrorNombreHorario").html(r),null==e&&(e=$("#txtNombreHorario"))}if(""==n){a=!1;r="Debe seleccionar un color para el horario necesariamente.";$("#divColorHorario").addClass("has-error"),$("#helpErrorColorHorario").html(r),null==e&&(e=$("#txtColorHorario"))}if("#FFFFFF"==n){a=!1;r="Seleccion&oacute; el color blanco para el horario, debe seleccionar un color diferente necesariamente.";$("#divColorHorario").addClass("has-error"),$("#helpErrorColorHorario").html(r),null==e&&(e=$("#txtColorHorario"))}if(""==i){a=!1;r="Debe seleccionar una hora de entrada necesariamente.";$("#divHoraEntHorario").addClass("has-error"),$("#helpErrorHoraEntHorario").html(r),null==e&&(e=$("#txtHoraEntHorario"))}if(""==t){a=!1;r="Debe seleccionar una hora de salida necesariamente.";$("#divHoraSalHorario").addClass("has-error"),$("#helpErrorHoraSalHorario").html(r),null==e&&(e=$("#txtHoraSalHorario"))}if(""==s){a=!1;r="Debe introducir los minutos de tolerancia acumulable necesariamente.";$("#divMinutosToleranciaAcu").addClass("has-error"),$("#helpErrorMinutosToleranciaAcu").html(r),null==e&&(e=$("#txtMinutosToleranciaAcu"))}if(""==l){a=!1;r="Debe introducir los minutos de tolerancia en la entrada del horario necesariamente.";$("#divMinutosToleranciaEnt").addClass("has-error"),$("#helpErrorMinutosToleranciaEnt").html(r),null==e&&(e=$("#txtMinutosToleranciaEnt"))}if(""==c){a=!1;r="Debe introducir los minutos de tolerancia en la salida del horario necesariamente.";$("#divMinutosToleranciaSal").addClass("has-error"),$("#helpErrorMinutosToleranciaSal").html(r),null==e&&(e=$("#txtMinutosToleranciaSal"))}if(""==d){a=!1;r="Debe introducir la hora de inicio del rango de marcaci&oacute;n para la entrada.";$("#divHoraInicioRangoEnt").addClass("has-error"),$("#helpErrorHoraInicioRangoEnt").html(r),null==e&&(e=$("#txtHoraInicioRangoEnt"))}if(""==h){a=!1;r="Debe introducir la hora de finalizaci&oacute;n del rango de marcaci&oacute;n para la entrada.";$("#divHoraFinalizacionRangoEnt").addClass("has-error"),$("#helpErrorHoraFinalizacionRangoEnt").html(r),null==e&&(e=$("#txtHoraFinalizacionRangoEnt"))}if(""==u){a=!1;r="Debe introducir la hora de inicio del rango de marcaci&oacute;n para la salida.";$("#divHoraInicioRangoSal").addClass("has-error"),$("#helpErrorHoraInicioRangoSal").html(r),null==e&&(e=$("#txtHoraInicioRangoSal"))}if(""==m){a=!1;r="Debe introducir la hora de finalizaci&oacute;n del rango de marcaci&oacute;n para la salida.";$("#divHoraFinalizacionRangoSal").addClass("has-error"),$("#helpErrorHoraFinalizacionRangoSal").html(r),null==e&&(e=$("#txtHoraFinalizacionRangoSal"))}return null!=e&&e.focus(),a}function limpiarMensajesErrorPorValidacionHorario(){$("#divNombreHorario").removeClass("has-error"),$("#helpErrorNombreHorario").html(""),$("#divColorHorario").removeClass("has-error"),$("#helpErrorColorHorario").html(""),$("#divHoraEntHorario").removeClass("has-error"),$("#helpErrorHoraEntHorario").html(""),$("#divHoraSalHorario").removeClass("has-error"),$("#helpErrorHoraSalHorario").html(""),$("#divMinutosToleranciaAcu").removeClass("has-error"),$("#helpErrorMinutosToleranciaAcu").html(""),$("#divMinutosToleranciaEnt").removeClass("has-error"),$("#helpErrorMinutosToleranciaEnt").html(""),$("#divMinutosToleranciaSal").removeClass("has-error"),$("#helpErrorMinutosToleranciaSal").html(""),$("#divHoraInicioRangoEnt").removeClass("has-error"),$("#helpErrorHoraInicioRangoEnt").html(""),$("#divHoraFinalizacionRangoEnt").removeClass("has-error"),$("#helpErrorHoraFinalizacionRangoEnt").html(""),$("#divHoraInicioRangoSal").removeClass("has-error"),$("#helpErrorHoraInicioRangoSal").html(""),$("#divHoraFinalizacionRangoSal").removeClass("has-error"),$("#helpErrorHoraFinalizacionRangoSal").html("")}function cargarTolerancias(e,o){var n=[],i="";$.ajax({url:"/tolerancias/list",type:"POST",datatype:"json",async:!1,cache:!1,data:{estado:1},success:function(a){var r=jQuery.parseJSON(a);$("#lstTolerancias").html(""),$("#lstTolerancias").prop("disabled",!1),$("#lstTolerancias").append("<option value='0'>Seleccionar...</option>"),0<r.length?($.each(r,function(a,r){o==r.id?($selected="selected",i="<td>&nbsp;</td><td class='text-center'>"+r.tolerancia+"</td><td class='text-center'>"+r.acumulacion_descripcion+"</td><td>"+r.consideracion_retraso_descripcion+"</td><td>"+r.descripcion+"</td><td>"+r.observacion+"</td>"):$selected="",$("#lstTolerancias").append("<option value="+r.id+" "+$selected+">"+r.id+"</option>"),sw=1,n.push({id:r.id,tolerancia:r.tolerancia,tipo_acumulacion:r.tipo_acumulacion,acumulacion_descripcion:r.acumulacion_descripcion,consideracion_retraso:r.consideracion_retraso,consideracion_retraso_descripcion:r.consideracion_retraso_descripcion,descripcion:r.descripcion,fecha_ini:r.fecha_ini,fecha_fin:r.fecha_fin,observacion:r.observacion})}),0!=sw&&5!=e||$("#lstTolerancias").prop("disabled","disabled")):$("#lstTolerancias").prop("disabled","disabled")}}),$("#tr_tolerancia").html(""),""!=i&&$("#tr_tolerancia").append(i),$("#lstTolerancias").off(),$("#lstTolerancias").on("change",function(){$("#tr_tolerancia").html(""),i="",$.each(n,function(a,r){r.id==$("#lstTolerancias").val()&&(i="<td>&nbsp;</td><td class='text-center'>"+r.tolerancia+"</td><td class='text-center'>"+r.acumulacion_descripcion+"</td><td>"+r.consideracion_retraso_descripcion+"</td><td>"+r.descripcion+"</td><td>"+r.observacion+"</td>")}),""!=i&&$("#tr_tolerancia").append(i)})}function cargarModalHorario(a){return 0<a&&($.ajax({url:"/horarioslaborales/getone",type:"POST",datatype:"json",async:!1,cache:!1,data:{id:a},success:function(a){var r=jQuery.parseJSON(a);0<r.length&&$.each(r,function(a,r){$("#txtNombreHorario").val(r.nombre),$("#txtNombreAlternativoHorario").val(r.nombre_alternativo),$("#txtColorHorario").val(r.color),$("#txtColorHorario").css({"background-color":r.color,color:r.color}),$("#txtHoraEntHorario").val(r.hora_entrada),$("#txtHoraSalHorario").val(r.hora_salida),$("#txtHoraInicioRangoEnt").val(r.hora_inicio_rango_ent),$("#txtHoraFinalizacionRangoEnt").val(r.hora_final_rango_ent),$("#txtHoraInicioRangoSal").val(r.hora_inicio_rango_sal),$("#txtHoraFinalizacionRangoSal").val(r.hora_final_rango_sal),1===r.agrupador?$("#chkPermitirCruce").prop("checked",!0):$("#chkPermitirCruce").prop("checked",!1),$("#txtObservacion").val(r.observacion);var e=r.hora_entrada,o=r.hora_salida;""==e&&(e="00:00:00"),""==o&&(o="00:00:00");var n=Number(parseFloat(r.horas_laborales));n=n.toFixed(2),$("#txtHorasLaborales").val(n)})}}),!0)}function obtenerDatosHorario(a){var e=[];return 0<a&&$.ajax({url:"/horarioslaborales/getone",type:"POST",datatype:"json",async:!1,cache:!1,data:{id:a},success:function(a){var r=jQuery.parseJSON(a);0<r.length&&$.each(r,function(a,r){e.push({nombre:r.nombre,nombre_alternativo:r.nombre_alternativo,color:r.color,hora_entrada:r.hora_entrada,hora_salida:r.hora_salida,hora_inicio_rango_ent:r.hora_inicio_rango_ent,hora_final_rango_ent:r.hora_final_rango_ent,hora_inicio_rango_sal:r.hora_inicio_rango_sal,observacion:r.observacion,horas_laborales:r.horas_laborales,dias_laborales:r.dias_laborales})})}}),e}function bajaTurnoEnCalendario(a){var e=!0;if(0<a)e=$.ajax({url:"/Calendariolaboral/down/",type:"POST",datatype:"json",async:!1,data:{id:a},success:function(a){var r=jQuery.parseJSON(a);$(".msjes").hide(),1==r.result?(e=!0,$("#divMsjePorSuccess").html(""),$("#divMsjePorSuccess").append(r.msj),$("#divMsjeNotificacionSuccess").jqxNotification("open")):0==r.result?($("#divMsjePorWarning").html(""),$("#divMsjePorWarning").append(r.msj),$("#divMsjeNotificacionWarning").jqxNotification("open")):($("#divMsjePorError").html(""),$("#divMsjePorError").append(r.msj),$("#divMsjeNotificacionError").jqxNotification("open"))},error:function(){alert("Se ha producido un error Inesperado")}}).responseText;else e=!1;return e}function calcularCantidadHorasLaborales(a,r){if(""==a||""==r)return 0;var e=numeroHoras(a),o=numeroHoras(r);return(parseFloat(o)>=parseFloat(e)?parseFloat(o)-parseFloat(e):24-parseFloat(e)+parseFloat(o)).toFixed(2)}function numeroHoras(a){if(""==a)return 0;var r=a.split(":"),e=parseFloat(r[0]),o=parseFloat(r[1]),n=parseFloat(r[2]),i=0,t=0;return 0<n&&(i=n/60),0<(o+=i)&&(t=o/60),e+=t}function sumarTotalHorasPorSemana(r){$("#calendar").fullCalendar("refetchEvents");var a=$("#calendar").fullCalendar("clientEvents"),t="-",s=($.fullCalendar.formatDate($("#calendar").fullCalendar("getView").start,"MM"),parseInt($.fullCalendar.formatDate($("#calendar").fullCalendar("getView").start,"MM"))),l=($.fullCalendar.formatDate($("#calendar").fullCalendar("getView").end,"dd-MM-yyyy"),0),c=0,d=0,h=0,u=0,m=0,p=0;$("#spSumaSemana1").html(0),$("#spSumaSemana2").html(0),$("#spSumaSemana3").html(0),$("#spSumaSemana4").html(0),$("#spSumaSemana5").html(0),$("#spSumaSemana6").html(0),$("#spSumaSemana6").html(0),$("#tdSumaSemana1").css("background-color","white"),$("#tdSumaSemana2").css("background-color","white"),$("#tdSumaSemana3").css("background-color","white"),$("#tdSumaSemana4").css("background-color","white"),$("#tdSumaSemana5").css("background-color","white"),$("#tdSumaSemana6").css("background-color","white"),$.each(a,function(a,o){var n=$.fullCalendar.formatDate(o.start,"dd-MM-yyyy"),i=$.fullCalendar.formatDate(o.end,"dd-MM-yyyy");""==i&&(i=n),$.each(r,function(a,r){var e=parseInt(r.fecha.split("-")[1]);1==r.semana&&procesaTextoAFecha(n,t)<=procesaTextoAFecha(r.fecha,t)&&procesaTextoAFecha(r.fecha,t)<=procesaTextoAFecha(i,t)&&(l+=parseFloat(o.horas_laborales),s==e&&(p+=parseFloat(o.horas_laborales))),2==r.semana&&procesaTextoAFecha(n,t)<=procesaTextoAFecha(r.fecha,t)&&procesaTextoAFecha(r.fecha,t)<=procesaTextoAFecha(i,t)&&(c+=parseFloat(o.horas_laborales),s==e&&(p+=parseFloat(o.horas_laborales))),3==r.semana&&procesaTextoAFecha(n,t)<=procesaTextoAFecha(r.fecha,t)&&procesaTextoAFecha(r.fecha,t)<=procesaTextoAFecha(i,t)&&(d+=parseFloat(o.horas_laborales),s==e&&(p+=parseFloat(o.horas_laborales))),4==r.semana&&procesaTextoAFecha(n,t)<=procesaTextoAFecha(r.fecha,t)&&procesaTextoAFecha(r.fecha,t)<=procesaTextoAFecha(i,t)&&(h+=parseFloat(o.horas_laborales),s==e&&(p+=parseFloat(o.horas_laborales))),5==r.semana&&procesaTextoAFecha(n,t)<=procesaTextoAFecha(r.fecha,t)&&procesaTextoAFecha(r.fecha,t)<=procesaTextoAFecha(i,t)&&(u+=parseFloat(o.horas_laborales),s==e&&(p+=parseFloat(o.horas_laborales))),6==r.semana&&procesaTextoAFecha(n,t)<=procesaTextoAFecha(r.fecha,t)&&procesaTextoAFecha(r.fecha,t)<=procesaTextoAFecha(i,t)&&(m+=parseFloat(o.horas_laborales),s==e&&(p+=parseFloat(o.horas_laborales)))})}),$("#spSumaSemana1").html(l.toFixed(2)),$("#spSumaSemana2").html(c.toFixed(2)),$("#spSumaSemana3").html(d.toFixed(2)),$("#spSumaSemana4").html(h.toFixed(2)),$("#spSumaSemana5").html(u.toFixed(2)),$("#spSumaSemana6").html(m.toFixed(2));var e=(c+d+h)/3;$("#spSumaPromedioTresSemanas").html(e.toFixed(2)),$("#spSumaHorasTodoElMes").html(p.toFixed(2));if(48<l){$("#tdSumaSemana1").css("background-color","#FF4000");var o="Las suma de horas en la primera semana es superior a las 48 horas permitidas.";$("#divMsjePorWarning").html(""),$("#divMsjePorWarning").append(o),$("#divMsjeNotificacionWarning").jqxNotification("open")}else $("#tdSumaSemana1").css("background-color","white");if(48<c){o="Las suma de horas en la segunda semana es superior a las 48 horas permitidas.";$("#divMsjePorWarning").html(""),$("#divMsjePorWarning").append(o),$("#divMsjeNotificacionWarning").jqxNotification("open"),$("#tdSumaSemana2").css("background-color","#FF4000")}else c<40?$("#tdSumaSemana2").css("background-color","blue"):$("#tdSumaSemana2").css("background-color","silver");if(48<d){o="Las suma de horas en la tercera semana es superior a las 48 horas permitidas.";$("#divMsjePorWarning").html(""),$("#divMsjePorWarning").append(o),$("#divMsjeNotificacionWarning").jqxNotification("open"),$("#tdSumaSemana3").css("background-color","#FF4000")}else d<40?$("#tdSumaSemana3").css("background-color","blue"):$("#tdSumaSemana3").css("background-color","silver");if(48<h){o="Las suma de horas en la cuarta semana es superior a las 48 horas permitidas.";$("#divMsjePorWarning").html(""),$("#divMsjePorWarning").append(o),$("#divMsjeNotificacionWarning").jqxNotification("open"),$("#tdSumaSemana4").css("background-color","#FF4000")}else h<40?$("#tdSumaSemana4").css("background-color","blue"):$("#tdSumaSemana4").css("background-color","silver");if(48<u){o="Las suma de horas en la quinta semana es superior a las 48 horas permitidas.";$("#divMsjePorWarning").html(""),$("#divMsjePorWarning").append(o),$("#divMsjeNotificacionWarning").jqxNotification("open"),$("#tdSumaSemana5").css("background-color","#FF4000")}else $("#tdSumaSemana5").css("background-color","white");if(48<m){o="Las suma de horas en la sexta semana es superior a las 48 horas permitidas.";$("#divMsjePorWarning").html(""),$("#divMsjePorWarning").append(o),$("#divMsjeNotificacionWarning").jqxNotification("open"),$("#tdSumaSemana6").css("background-color","#FF4000")}else $("#tdSumaSemana6").css("background-color","white");if(48<e){$("#tdSumaPromedioTresSemanas").css("background-color","red");o="El promedio de horas en las 3 semanas seleccionadas es superior a las 48 horas permitidas.";$("#divMsjePorWarning").html(""),$("#divMsjePorWarning").append(o),$("#divMsjeNotificacionWarning").jqxNotification("open")}else $("#tdSumaPromedioTresSemanas").css("background-color","white")}function cargarJornadasLaborales(e,o){$.ajax({url:"/calendariolaboral/listjornadaslaborales",type:"POST",datatype:"json",async:!1,cache:!1,success:function(a){var r=jQuery.parseJSON(a);$("#lstJornadasLaborales").html(""),$("#lstJornadasLaborales").prop("disabled",!1),$("#lstJornadasLaborales").append("<option value='0'>Seleccionar...</option>"),0<r.length?($.each(r,function(a,r){o==r.id?$selected="selected":$selected="",$("#lstJornadasLaborales").append("<option value='"+r.id+"::"+r.horas_semanales+"::"+r.horas_dia+"::"+r.horas_noche+"' "+$selected+">"+r.jornada_laboral+" - (<="+r.horas_semanales+" HRS.)</option>")}),5==e&&$("#lstJornadasLaborales").prop("disabled","disabled")):$("#lstJornadasLaborales").prop("disabled","disabled")}})}function obtenerFechasDeCalendario(a,r,e){var o=[];return $.ajax({url:"/calendariolaboral/getrangofechas",type:"POST",datatype:"json",async:!1,cache:!1,data:{fin_de_semana:e},success:function(a){var r=jQuery.parseJSON(a);0<r.length&&$.each(r,function(a,r){o.push({fecha:r.fecha,dia:"d_"+r.dia,fin_de_semana:r.fin_de_semana})})}}),o}function agregarColumnaSumaTotales(a){$(".fc-border-separate tr:first").append("<th style='width: 87px;' id='thColumnaTotales' class='thColumnaTotales'> Hrs Semana </th>");var e=0;$(".fc-border-separate tr.fc-week").each(function(a,r){e++,$(this).append("<td id='tdSumaSemana"+e+"' class='tdSumaSemana fc-last'><div style='min-height: 67px;align-content: center;'><div id='divSumaSemana"+e+"' class='fc-day-suma-horas-semana'><span id='spSumaSemana"+e+"' class='spSumaSemana'>100</span></div></div></td>")});var r=a+1;$(".fc-border-separate tr:last").after("<tr id=''><td style='text-align: right;' colspan='"+r+"' class=''><b>Promedio semanal de horas (3 Semanas marcadas):</b></td><td id='tdSumaPromedioTresSemanas' class='tdSumaPromedioTresSemanas fc-first fc-day fc-last'><div style='min-height: 67px;align-content: center;'><div id='divSumaPromedioTresSemanas' class='fc-suma-promedio-horas-3-semanas'><span id='spSumaPromedioTresSemanas'>0</span></div></div></td></tr>"),$(".fc-border-separate tr:last").after("<tr id=''><td style='text-align: right;' colspan='"+r+"' class=''><b>Total de horas en el mes:</b></td><td id='tdSumaHorasTodoElMes' class='tdSumaPromedioTresSemanas fc-first fc-day fc-last'><div style='min-height: 67px;align-content: center;'><div id='divSumaHorasTodoElMes' class='fc-suma-promedio-horas-3-semanas'><span id='spSumaHorasTodoElMes'>0</span></div></div></td></tr>")}function removerColumnaSumaTotales(){$("#thColumnaTotales").remove(),$("#tdSumaSemana1").remove(),$("#tdSumaSemana2").remove(),$("#tdSumaSemana3").remove(),$("#tdSumaSemana4").remove(),$("#tdSumaSemana5").remove(),$("#tdSumaSemana6").remove(),$("#trSumaPromedioTresSemanas").remove(),$("#spSumaHorasTodoElMes").remove()}function calcularFechasPorSemana(){var n=[],i=0;return $.each(["mon","tue","wed","thu","fri","sat","sun"],function(a,r){i=0,$("td.fc-"+r).map(function(a,r){i++;var e=$(this).data("date");$(this).data("date");if(null!=e){var o=e.split("-");switch(e=o[2]+"-"+o[1]+"-"+o[0],i){case 1:n.push({semana:1,fecha:e});break;case 2:n.push({semana:2,fecha:e});break;case 3:n.push({semana:3,fecha:e});break;case 4:n.push({semana:4,fecha:e});break;case 5:n.push({semana:5,fecha:e});break;case 6:n.push({semana:6,fecha:e})}}})}),n}