function exportarReportePlanillasRef(e,i){columna=new Object,filtros=new Object,agrupados=new Object,ordenados=new Object,gerencia_administrativa=$("#divGridPlanillasRefView").jqxGrid("getcolumn","gerencia_administrativa"),departamento_administrativo=$("#divGridPlanillasRefView").jqxGrid("getcolumn","departamento_administrativo"),area=$("#divGridPlanillasRefView").jqxGrid("getcolumn","area"),ubicacion=$("#divGridPlanillasRefView").jqxGrid("getcolumn","ubicacion"),fin_partida=$("#divGridPlanillasRefView").jqxGrid("getcolumn","fin_partida"),proceso_codigo=$("#divGridPlanillasRefView").jqxGrid("getcolumn","proceso_codigo"),cargo=$("#divGridPlanillasRefView").jqxGrid("getcolumn","cargo"),estado_descripcion=$("#divGridPlanillasRefView").jqxGrid("getcolumn","estado_descripcion"),nombres=$("#divGridPlanillasRefView").jqxGrid("getcolumn","nombres"),ci=$("#divGridPlanillasRefView").jqxGrid("getcolumn","ci"),expd=$("#divGridPlanillasRefView").jqxGrid("getcolumn","expd"),nivelsalarial=$("#divGridPlanillasRefView").jqxGrid("getcolumn","nivelsalarial"),sueldo=$("#divGridPlanillasRefView").jqxGrid("getcolumn","sueldo"),dias_efectivos=$("#divGridPlanillasRefView").jqxGrid("getcolumn","dias_efectivos"),monto_diario=$("#divGridPlanillasRefView").jqxGrid("getcolumn","monto_diario"),lsgh=$("#divGridPlanillasRefView").jqxGrid("getcolumn","lsgh"),faltas=$("#divGridPlanillasRefView").jqxGrid("getcolumn","faltas"),vacacion=$("#divGridPlanillasRefView").jqxGrid("getcolumn","vacacion"),otros=$("#divGridPlanillasRefView").jqxGrid("getcolumn","otros"),importe=$("#divGridPlanillasRefView").jqxGrid("getcolumn","importe"),rc_iva=$("#divGridPlanillasRefView").jqxGrid("getcolumn","rc_iva"),retencion=$("#divGridPlanillasRefView").jqxGrid("getcolumn","retencion"),fecha_form=$("#divGridPlanillasRefView").jqxGrid("getcolumn","fecha_form"),form110impref_observacion=$("#divGridPlanillasRefView").jqxGrid("getcolumn","form110impref_observacion"),total_ganado=$("#divGridPlanillasRefView").jqxGrid("getcolumn","total_ganado"),total_liquido=$("#divGridPlanillasRefView").jqxGrid("getcolumn","total_liquido"),columna[gerencia_administrativa.datafield]={text:gerencia_administrativa.text,hidden:gerencia_administrativa.hidden},columna[departamento_administrativo.datafield]={text:departamento_administrativo.text,hidden:departamento_administrativo.hidden},columna[area.datafield]={text:area.text,hidden:area.hidden},columna[ubicacion.datafield]={text:ubicacion.text,hidden:ubicacion.hidden},columna[fin_partida.datafield]={text:fin_partida.text,hidden:fin_partida.hidden},columna[proceso_codigo.datafield]={text:proceso_codigo.text,hidden:proceso_codigo.hidden},columna[cargo.datafield]={text:cargo.text,hidden:cargo.hidden},columna[estado_descripcion.datafield]={text:estado_descripcion.text,hidden:estado_descripcion.hidden},columna[nombres.datafield]={text:nombres.text,hidden:nombres.hidden},columna[ci.datafield]={text:ci.text,hidden:ci.hidden},columna[expd.datafield]={text:expd.text,hidden:expd.hidden},columna[nivelsalarial.datafield]={text:nivelsalarial.text,hidden:nivelsalarial.hidden},columna[sueldo.datafield]={text:sueldo.text,hidden:sueldo.hidden},columna[dias_efectivos.datafield]={text:dias_efectivos.text,hidden:dias_efectivos.hidden},columna[monto_diario.datafield]={text:monto_diario.text,hidden:monto_diario.hidden},columna[lsgh.datafield]={text:lsgh.text,hidden:lsgh.hidden},columna[faltas.datafield]={text:faltas.text,hidden:faltas.hidden},columna[vacacion.datafield]={text:vacacion.text,hidden:vacacion.hidden},columna[otros.datafield]={text:otros.text,hidden:otros.hidden},columna[importe.datafield]={text:importe.text,hidden:importe.hidden},columna[rc_iva.datafield]={text:rc_iva.text,hidden:rc_iva.hidden},columna[retencion.datafield]={text:retencion.text,hidden:retencion.hidden},columna[fecha_form.datafield]={text:fecha_form.text,hidden:fecha_form.hidden},columna[form110impref_observacion.datafield]={text:form110impref_observacion.text,hidden:form110impref_observacion.hidden},columna[total_ganado.datafield]={text:total_ganado.text,hidden:total_ganado.hidden},columna[total_liquido.datafield]={text:total_liquido.text,hidden:total_liquido.hidden};var a=$("#divGridPlanillasRefView").jqxGrid("groups");null!=a&&""!=a||(a="null");var d=$("#divGridPlanillasRefView").jqxGrid("getsortinformation");if(null!=d.sortcolumn){var t=d.sortcolumn,l=d.sortdirection;ordenados[t]={asc:l.ascending,desc:l.descending}}else ordenados="";for(var n=$("#divGridPlanillasRefView").jqxGrid("getrows"),o=$("#divGridPlanillasRefView").jqxGrid("getfilterinformation"),r=0,c=0;c<o.length;c++)for(var s=o[c],f=s.filter.getfilters(),m=0;m<f.length;m++){0<m&&r++,filtros[c+r]={columna:s.filtercolumn,valor:f[m].value,condicion:f[m].condition,tipo:f[m].type}}var u=n.length,x=JSON.stringify(filtros),g=JSON.stringify(columna),v=JSON.stringify(ordenados);g=btoa(utf8_encode(g)),x=btoa(utf8_encode(x)),v=btoa(utf8_encode(v));var h=btoa(utf8_encode(a));g=g.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),x=x.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),h=h.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,""),v=v.replace(/\+/g,"-").replace(/\//g,"_").replace(/\=+$/,"");var _="";switch(e){case 1:_="/planillasref/exportviewexcel";break;case 2:_="/planillasref/exportviewpdf"}""!=_&&window.open(_+"/"+i+"/"+u+"/"+g+"/"+x+"/"+h+"/"+v,"_blank")}function utf8_encode(e){if(null==e)return"";var i,a,d,t=e+"",l="";i=a=0,d=t.length;for(var n=0;n<d;n++){var o=t.charCodeAt(n),r=null;if(o<128)a++;else if(127<o&&o<2048)r=String.fromCharCode(o>>6|192,63&o|128);else if(55296!=(63488&o))r=String.fromCharCode(o>>12|224,o>>6&63|128,63&o|128);else{if(55296!=(64512&o))throw new RangeError("Unmatched trail surrogate at "+n);var c=t.charCodeAt(++n);if(56320!=(64512&c))throw new RangeError("Unmatched lead surrogate at "+(n-1));o=((1023&o)<<10)+(1023&c)+65536,r=String.fromCharCode(o>>18|240,o>>12&63|128,o>>6&63|128,63&o|128)}null!==r&&(i<a&&(l+=t.slice(i,a)),l+=r,i=a=n+1)}return i<a&&(l+=t.slice(i,d)),l}