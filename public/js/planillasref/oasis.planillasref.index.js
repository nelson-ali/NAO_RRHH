function definirGrillaParaListaPlanillasDeRefrigerio(){var a=new $.jqx.dataAdapter({datatype:"json",datafields:[{name:"nro_row",type:"integer"},{name:"id",type:"integer"},{name:"gestion",type:"integer"},{name:"mes",type:"integer"},{name:"mes_nombre",type:"string"},{name:"finpartida_id",type:"integer"},{name:"fin_partida",type:"string"},{name:"condicion_id",type:"integer"},{name:"condicion",type:"string"},{name:"tipoplanilla_id",type:"integer"},{name:"tipo_planilla",type:"string"},{name:"numero",type:"integer"},{name:"total_ganado",type:"numeric"},{name:"total_liquido",type:"numeric"},{name:"cantidad_relaborales",type:"numeric"},{name:"observacion",type:"string"},{name:"estado",type:"string"},{name:"estado_descripcion",type:"string"}],url:"/planillasref/list",cache:!1});!function(){var e=prepareSimulator("grid");$("#divGridPlanillasRef").jqxGrid({theme:e,width:"100%",height:"440px",source:a,sortable:!0,altRows:!0,groupable:!0,columnsresize:!0,pageable:!0,pagerMode:"advanced",showfilterrow:!0,filterable:!0,showtoolbar:!0,autorowheight:!0,rendertoolbar:function(e){var a=$("<div></div>");e.append(a),a.append("<button id='addplanrowbutton' class='btn btn-sm btn-primary' type='button'><i class='fa fa-plus-square fa-2x text-primary' title='Nuevo Registro.'/></i></button>"),a.append("<button id='editplanrowbutton' class='btn btn-sm btn-primary' type='button'><i class='fa fa-pencil-square fa-2x text-success' title='Editar Observaci&oacute;n de Registro.'/></i></button>"),a.append("<button id='viewplanrowbutton'  class='btn btn-sm btn-primary' type='button' ><i class='fa fa-search fa-2x text-purple' title='Ver Registros de Planilla.'/></button>"),a.append("<button id='approveplanrowbutton'  class='btn btn-sm btn-primary' type='button' ><i class='fa fa-check-square fa-2x text-success' title='Aprobar registro'></i></button>"),a.append("<button id='othersrowbutton'  class='btn btn-sm btn-primary' type='button' ><i class='fa fa fa-puzzle-piece fa-2x text-info' title='Otras Boletas'></i></button>"),a.append("<button id='deleteplanrowbutton' class='btn btn-sm btn-primary' type='button'><i class='fa fa-minus-square fa-2x text-danger' title='Dar de baja al registro.'/></i></button>"),a.append("<button title='Refrescar Grilla' id='refreshbutton' class='btn btn-sm btn-primary' type='button'><i class='fa fa-repeat fa-2x text-default' title='Refrescar grilla.'/></i></button>"),a.append("<button title='Desagrupar.' id='cleargroupsrowbutton' class='btn btn-sm btn-primary' type='button'><i class='fa fa-chain-broken fa-2x text-default' title='Desagrupar.'/></i></button>"),a.append("<button title='Desfiltrar.' id='clearfiltersrowbutton' class='btn btn-sm btn-primary' type='button'><i class='gi gi-sorting fa-2x text-default' title='Desfiltrar.'/></i></button>"),$("#addplanrowbutton").jqxButton(),$("#editplanrowbutton").jqxButton(),$("#approveplanrowbutton").jqxButton(),$("#othersrowbutton").jqxButton(),$("#deleteplanrowbutton").jqxButton(),$("#viewplanrowbutton").jqxButton(),$("#refreshbutton").jqxButton(),$("#cleargroupsrowbutton").jqxButton(),$("#clearfiltersrowbutton").jqxButton(),$("#hdnIdPlanillaRef").val(0),$("#refreshbutton").off(),$("#refreshbutton").on("click",function(){$("#divGridPlanillasRef").jqxGrid("updatebounddata")}),$("#cleargroupsrowbutton").off(),$("#cleargroupsrowbutton").on("click",function(){$("#divGridPlanillasRef").jqxGrid("cleargroups")}),$("#clearfiltersrowbutton").off(),$("#clearfiltersrowbutton").on("click",function(){$("#divGridPlanillasRef").jqxGrid("clearfilters")}),$("#addplanrowbutton").off(),$("#addplanrowbutton").on("click",function(){$("#btnCalcularPlanillaPreviaRef").hide(),$("#divTabPlanillasRef").jqxTabs("enableAt",1),$("#divTabPlanillasRef").jqxTabs("disableAt",2),$("#divTabPlanillasRef").jqxTabs({selectedItem:1}),$("#divGridPlanillasRefGen").jqxGrid("clear"),$("#divGridPlanillasRefGen").jqxGrid("selectallrows",!1),limpiarFormularioPlanillaRef(1),cargarGestiones(1,0),cargarMeses(1,0,0),cargarFinPartidas(1,0,0,0),cargarTiposDePlanilla(1,0,0,0,0),desplegarPlanillaPreviaRef(),$("#lstGestionGen").focus(),$("#lstGestionGen").off(),$("#lstGestionGen").on("change",function(){cargarMeses(1,$("#lstGestionGen").val(),0),cargarFinPartidas(1,$("#lstGestionGen").val(),0,0),cargarTiposDePlanilla(1,$("#lstGestionGen").val(),0,0,0),$("#btnGenerarPlanillaRef").hide(),$("#btnCalcularPlanillaPreviaRef").hide()}),$("#lstMesGen").off(),$("#lstMesGen").on("change",function(){cargarFinPartidas(1,$("#lstGestionGen").val(),$("#lstMesGen").val(),0),cargarTiposDePlanilla(1,$("#lstGestionGen").val(),$("#lstMesGen").val(),0,0),$("#btnGenerarPlanillaRef").hide(),$("#btnCalcularPlanillaPreviaRef").hide()}),$("#lstFinPartidaGen").off(),$("#lstFinPartidaGen").on("change",function(){cargarTiposDePlanilla(1,$("#lstGestionGen").val(),$("#lstMesGen").val(),$("#lstFinPartidaGen").val(),0),$("#btnGenerarPlanillaRef").hide(),$("#btnCalcularPlanillaPreviaRef").hide()}),$("#lstTipoPlanillaRefGen").off(),$("#lstTipoPlanillaRefGen").on("change",function(){$("#btnGenerarPlanillaRef").hide(),$("#btnCalcularPlanillaPreviaRef").hide()})}),$("#editplanrowbutton").off(),$("#editplanrowbutton").on("click",function(){var e=$("#divGridPlanillasRef").jqxGrid("getselectedrowindex");if(0<=e){var a=$("#divGridPlanillasRef").jqxGrid("getrowdata",e);if(null!=a)if(1==a.estado||2==a.estado){var i="";$("#popupObservacionPlanillaRefEdit").modal("show"),$("#popupObservacionPlanillaRefEdit").on("shown.bs.modal",function(){$("#txtObservacionPlanillaRefEdit").focus()}),$("#txtObservacionPlanillaRefEdit").focus(),$("#txtObservacionPlanillaRefEdit").val(a.observacion),$("#btnAplicarObservacionPlanillaRefEdit").off(),$("#btnAplicarObservacionPlanillaRefEdit").on("click",function(){$("#popupObservacionPlanillaRefEdit").modal("hide"),i=$("#txtObservacionPlanillaRefEdit").val(),modificarObservacionEnPlanillaRef(a.id,0,i)})}else{var l="Debe seleccionar un registro de Planilla Salarial en estado GENERADA O VERIFICADA para poder modificar la observaci&oacute;n de la observaci&oacute;n de la planilla.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(l),$("#divMsjeNotificacionError").jqxNotification("open")}else{var l="Debe seleccionar un registro de Planilla Salarial necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(l),$("#divMsjeNotificacionError").jqxNotification("open")}}else{var l="Debe seleccionar un registro de Planilla Salarial necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(l),$("#divMsjeNotificacionError").jqxNotification("open")}}),$("#viewplanrowbutton").off(),$("#viewplanrowbutton").on("click",function(){var e=$("#divGridPlanillasRef").jqxGrid("getselectedrowindex");if(0<=e){var a=$("#divGridPlanillasRef").jqxGrid("getrowdata",e);if(null!=a){$("#divTabPlanillasRef").jqxTabs("disableAt",1),$("#divTabPlanillasRef").jqxTabs("enableAt",2),$("#divTabPlanillasRef").jqxTabs({selectedItem:2}),$("#tbodyDatosPlanillaRef").html("");var i="";$("#tbodyDatosPlanillaRef").append("<tr class='success'>"),$("#tbodyDatosPlanillaRef").append("<td style='text-align: center'>"+a.estado_descripcion+"</td>"),$("#tbodyDatosPlanillaRef").append("<td style='text-align: center'>"+a.gestion+"</td>"),$("#tbodyDatosPlanillaRef").append("<td style='text-align: center'>"+a.mes_nombre+"</td>"),$("#tbodyDatosPlanillaRef").append("<td>"+a.fin_partida+"</td>");var l=a.tipo_planilla;0<a.numero&&(l+=" ("+a.numero+")"),$("#tbodyDatosPlanillaRef").append("<td style='text-align: center'>"+l+"</td>"),null!=a.observacion&&(i=a.observacion),$("#tbodyDatosPlanillaRef").append("<td>"+i+"</td>"),$("#tbodyDatosPlanillaRef").append("</tr>"),$("#hdnIdPlanillaRef").val(a.id),$("#divPlanilllaRefViewListBox").jqxListBox("refresh"),mostrarPlanillaDeRefrigerio(a.id)}else{var t="Debe seleccionar un registro de Planilla de Refrigerio necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(t),$("#divMsjeNotificacionError").jqxNotification("open")}}else{var t="Debe seleccionar un registro de Planilla de Refrigerio necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(t),$("#divMsjeNotificacionError").jqxNotification("open")}}),$("#approveplanrowbutton").on("click",function(){var e=$("#divGridPlanillasRef").jqxGrid("getselectedrowindex");if(0<=e){var a=$("#divGridPlanillasRef").jqxGrid("getrowdata",e);if(null!=a)if(1==a.estado||2==a.estado)confirm("¿Esta segur@ de aprobar esta planilla?")&&aprobarRegistroPlanillaRef(a.id);else{var i="Debe seleccionar un registro con estado GENERADA o VERIFICADA para posibilitar la aprobaci&oacute;n del registro.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}else{var i="Debe seleccionar un registro necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}),$("#deleteplanrowbutton").on("click",function(){var e=$("#divGridPlanillasRef").jqxGrid("getselectedrowindex");if(0<=e){var a=$("#divGridPlanillasRef").jqxGrid("getrowdata",e);if(null!=a)if(1==a.estado||2==a.estado)confirm("Esta seguro de dar de baja registro de Planilla de Refrigerio?")&&darDeBajaPlanillaRef(a.id);else{var i="Para dar de baja un registro, este debe estar en estado GENERADA o VERIFICADA inicialmente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}else{var i="Debe seleccionar un registro necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}),$("#othersrowbutton").on("click",function(){var e=$("#divGridPlanillasRef").jqxGrid("getselectedrowindex");if(0<=e){var a=$("#divGridPlanillasRef").jqxGrid("getrowdata",e);null!=a&&cargarModalListadoOtrasBoletasPorPlanilla(a.id)}else{$("#divMsjePorError").html(""),$("#divMsjePorError").append("Debe seleccionar un registro necesariamente."),$("#divMsjeNotificacionError").jqxNotification("open")}})},columns:[{text:"Nro.",filterable:!1,columntype:"number",width:40,cellsalign:"center",align:"center",cellsrenderer:rownumberrenderer},{text:"Estado",filtertype:"checkedlist",datafield:"estado_descripcion",width:90,cellsalign:"center",align:"center",hidden:!1,cellclassname:cellclass},{text:"Gesti&oacute;n",filtertype:"checkedlist",datafield:"gestion",width:60,cellsalign:"center",align:"center",hidden:!1},{text:"Mes",filtertype:"checkedlist",datafield:"mes_nombre",width:100,cellsalign:"center",align:"center",hidden:!1},{text:"Condici&oacute;n",filtertype:"checkedlist",datafield:"condicion",width:200,align:"center",cellsalign:"center",hidden:!1},{text:"Fuente",filtertype:"checkedlist",datafield:"fin_partida",width:350,align:"center",cellsalign:"center",hidden:!1},{text:"Tipo Planilla",filtertype:"checkedlist",datafield:"tipo_planilla",width:80,cellsalign:"center",align:"center",hidden:!1},{text:"N&uacute;mero",filtertype:"checkedlist",datafield:"numero",width:60,align:"center",cellsalign:"center",hidden:!1},{text:"Total Ganado",filtertype:"checkedlist",datafield:"total_ganado",width:90,align:"center",cellsalign:"right",hidden:!1},{text:"Total L&iacute;quido",filtertype:"checkedlist",datafield:"total_liquido",width:90,align:"center",cellsalign:"right",hidden:!1},{text:"Cantidad",filtertype:"checkedlist",datafield:"cantidad_relaborales",width:60,align:"center",cellsalign:"center",hidden:!1},{text:"Observaci&oacute;n",datafield:"observacion",width:130,align:"center",hidden:!1}]});$("#listBoxPlanillasRef").jqxListBox({source:[{label:"Estado",value:"estado_descripcion",checked:!0},{label:"Gesti&oacute;n",value:"gestion",checked:!0},{label:"Mes",value:"mes_nombre",checked:!0},{label:"Condici&oacute;n",value:"condicion",checked:!0},{label:"Fuente",value:"fin_partida",checked:!0},{label:"Tipo Planilla",value:"tipo_planilla",checked:!0},{label:"N&uacute;mero",value:"numero",checked:!0},{label:"Total Ganado",value:"total_ganado",checked:!0},{label:"Total L&iacute;quido",value:"total_liquido",checked:!0},{label:"Cantidad",value:"cantidad_relaborales",checked:!0},{label:"Observaci&oacute;n",value:"observacion",checked:!0}],width:"100%",height:370,checkboxes:!0}),$("#listBoxPlanillasRef").on("checkChange",function(e){$("#divGridPlanillasRef").jqxGrid("beginupdate"),e.args.checked?$("#divGridPlanillasRef").jqxGrid("showcolumn",e.args.value):$("#divGridPlanillasRef").jqxGrid("hidecolumn",e.args.value),$("#divGridPlanillasRef").jqxGrid("endupdate")})}()}$().ready(function(){$("#divTabPlanillasRef").jqxTabs("theme","oasis"),$("#divTabPlanillasRef").jqxTabs("enableAt",0),$("#divTabPlanillasRef").jqxTabs("disableAt",1),$("#divTabPlanillasRef").jqxTabs("disableAt",2),definirGrillaParaListaPlanillasDeRefrigerio(),$("#btnGenerarPlanillaPreviaRef").on("click",function(){$("#btnGenerarPlanillaRef").hide(),limpiarFormularioPlanillaRef(1),validaFormularioPlanillaRef(1)?desplegarPlanillaPreviaRef(""):$("#divGridPlanillasRefGen").jqxGrid("clear")}),$("#btnCalcularPlanillaPreviaRef").on("click",function(){var e=0;if(limpiarFormularioPlanillaRef(1),validaFormularioPlanillaRef(2)){var a=$("#divGridPlanillasRefGen").jqxGrid("selectedrowindexes");if(0<a.length){for(var i="",l="|",t=(new Array,0);t<a.length;t++){e++,i+=$("#divGridPlanillasRefGen").jqxGrid("getrowdata",a[t]).id_relaboral+l}if(0<=e)i=(i+=l).replace(l+l,""),desplegarPlanillaPreviaRef(i),$("#btnGenerarPlanillaRef").show();else{var n="Debe seleccionar al menos un registro v&aacute;lido (D&iacute;as efectivos mayor a cero) para de la Planilla de Refrigerio.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(n),$("#divMsjeNotificacionError").jqxNotification("open")}}else{n="Debe seleccionar al menos un registro para el c&aacute;lculo de la Planilla de Refrigerio.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(n),$("#divMsjeNotificacionError").jqxNotification("open")}}}),$("#btnGenerarPlanillaRef").on("click",function(){var e=0;limpiarFormularioPlanillaRef(1);var a=validaFormularioPlanillaRef(1);if(a){var i=$("#divGridPlanillasRefGen").jqxGrid("selectedrowindexes");if(0<i.length){for(var l="",t="|",n=(new Array,0);n<i.length;n++){var r=$("#divGridPlanillasRefGen").jqxGrid("getrowdata",i[n]);0<r.dias_efectivos&&(e++,l+=r.id_relaboral+t)}if(0<e){l=(l+=t).replace(t+t,"");var o="Gen",s=$("#lstGestion"+o).val(),d=$("#lstMes"+o).val(),c=$("#lstFinPartida"+o).val(),f=$("#lstTipoPlanillaRef"+o).val(),b=$("#lstTipoPlanillaRefGen option:selected").data("numero"),p="";$("#txtObservacionPlanillaRef").val(""),$("#popupObservacionPlanillaRef").modal("show"),$("#popupObservacionPlanillaRef").on("shown.bs.modal",function(){$("#txtObservacionPlanillaRef").focus()}),$("#btnAplicarObservacionPlanillaRef").off(),$("#btnAplicarObservacionPlanillaRef").on("click",function(){$("#popupObservacionPlanillaRef").modal("hide"),p=$("#txtObservacionPlanillaRef").val(),(a=generarPlanillaDeRefrigerio(s,d,c,f,b,l,p))&&($("#divTabPlanillasRef").jqxTabs("enableAt",0),$("#divTabPlanillasRef").jqxTabs("disableAt",1),$("#divTabPlanillasRef").jqxTabs("disableAt",2),$("#divTabPlanillasRef").jqxTabs({selectedItem:0}),$("#divGridPlanillasRef").jqxGrid("updatebounddata","cells"))})}else{var u="Debe seleccionar al menos un registro v&aacute;lido (D&iacute;as efectivos mayor a cero) para la generaci&oacute;n de la Planilla de Refrigerio.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(u),$("#divMsjeNotificacionError").jqxNotification("open")}}else{u="Debe seleccionar al menos un registro para la generaci&oacute;n de la Planilla de Refrigerio.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(u),$("#divMsjeNotificacionError").jqxNotification("open")}}}),$("#btnGuardarForm110ImpRef").on("click",function(){validaFormulario110ImpRef()&&(guardarFormulario110ImpRef()&&(actualizaFila(),$("#popupFormulario110ImpRef").modal("hide")))}),$("#liList").on("click",function(){$("#divTabPlanillasRef").jqxTabs("enableAt",0),$("#divTabPlanillasRef").jqxTabs("disableAt",1),$("#divTabPlanillasRef").jqxTabs("disableAt",2),$("#msjs-alert").hide()}),$("#btnGuardarExcepcionEdit").on("click",function(){validaFormularioExcepcion(2)&&(guardaExcepcion(2)&&($("#divTabPlanillasSal").jqxTabs("enableAt",0),$("#divTabPlanillasSal").jqxTabs("disableAt",1),$("#divTabPlanillasSal").jqxTabs("disableAt",2),$("#msjs-alert").hide()))}),$("#btnCancelarExcepcionNew").click(function(){$("#divTabPlanillasSal").jqxTabs("enableAt",0),$("#divTabPlanillasSal").jqxTabs("disableAt",1),$("#divTabPlanillasSal").jqxTabs("disableAt",2),$("#msjs-alert").hide()}),$("#btnCancelarExcepcionEdit").click(function(){$("#divTabPlanillasSal").jqxTabs("enableAt",0),$("#divTabPlanillasSal").jqxTabs("disableAt",1),$("#divTabPlanillasSal").jqxTabs("disableAt",2),$("#msjs-alert").hide()}),$("#btnExportarGenExcel").on("click",function(){$("#divGridPlanillasRefGen").jqxGrid("exportdata","xml","PlanillaSalPrevia")}),$("#btnExportarPDF").click(function(){var e=$("#listBoxPlanillasSal").jqxListBox("getCheckedItems"),i=0;$.each(e,function(e,a){i++}),0<i?exportarReporte(2):(alert("Debe seleccionar al menos una columna para la obtención del reporte solicitado."),$("#listBoxPlanillasRef").focus())}),$("#chkAllCols").click(function(){1==this.checked?$("#listBoxPlanillasRef").jqxListBox("checkAll"):$("#listBoxPlanillasRef").jqxListBox("uncheckAll")}),$("#liList").click(function(){$("#btnCancelarExcepcionNew").click(),$("#btnCancelarExcepcionEdit").click()}),$("#btnDesfiltrartodo").click(function(){$("#divGridPlanillasRef").jqxGrid("clearfilters")}),$("#btnDesfiltrarTodoPlanillasRefView").click(function(){$("#divGridPlanillasRefView").jqxGrid("clearfilters")}),$("#btnDesfiltrarTodoPlanillasRefGen").click(function(){$("#divGridPlanillasRefGen").jqxGrid("clearfilters")}),$("#btnDesagrupartodo").click(function(){$("#divGridPlanillasRef").jqxGrid("cleargroups")}),$("#btnDesagruparTodoPlanillasRefView").click(function(){$("#divGridPlanillasRefView").jqxGrid("cleargroups")}),$("#btnDesagruparTodoMovilidad").click(function(){$("#divGridPlanillasRefmovilidad").jqxGrid("cleargroups")}),$(".numeral").keyup(function(e){""!=$(this).val()&&$(this).val($(this).val().replace(/[^0-9]/g,""))}),$(".literal").keyup(function(e){""!=$(this).val()&&$(this).val($(this).val().replace(/[^A-Z,a-z,ñ,Ñ, ]/g,""))}),$("#divMsjeNotificacionError").jqxNotification({width:"100%",position:"bottom-right",opacity:.9,autoOpen:!1,animationOpenDelay:800,autoClose:!0,autoCloseDelay:7e3,template:"error"}),$("#divMsjeNotificacionWarning").jqxNotification({width:"100%",position:"bottom-right",opacity:.9,autoOpen:!1,animationOpenDelay:800,autoClose:!0,autoCloseDelay:7e3,template:"warning"}),$("#divMsjeNotificacionSuccess").jqxNotification({width:"100%",position:"bottom-right",opacity:.9,autoOpen:!1,animationOpenDelay:800,autoClose:!0,autoCloseDelay:7e3,template:"success"}),$(document).keypress(OperaEvento),$(document).keyup(OperaEvento)});var rownumberrenderer=function(e,a,i,l,t,n){return"<div align='center'>"+(e+1)+"</div>"};function OperaEvento(e){"keyup"!=e.type&&"keydown"!=e.type||"27"!=e.which||($("#divTabPlanillasRef").jqxTabs("enableAt",0),$("#divTabPlanillasRef").jqxTabs("disableAt",1),$("#divTabPlanillasRef").jqxTabs("disableAt",2),$("#divTabPlanillasRef").jqxTabs({selectedItem:0}))}var cellclass=function(e,a,i){return"ANULADA"==i||"PASIVO"===i||"APROBACION RECHAZADA"===i?"rojo":"REVERTIDA"==i?"negro":"GENERADA"==i?"amarillo":"VERIFICADA"==i?"azul":"APROBADA"==i||"ACTIVO"==i||"APROBADO"==i?"verde":""},cellsrenderer=function(e,a,i,l){var t=$(l);return t.css({"background-color":i}),t[0].outerHTML};