function definirGrillaParaListaTolerancias(){var a=new $.jqx.dataAdapter({datatype:"json",datafields:[{name:"nro_row",type:"integer"},{name:"id",type:"integer"},{name:"tolerancia",type:"integer"},{name:"tipo_acumulacion",type:"integer"},{name:"acumulacion_descripcion",type:"time"},{name:"consideracion_retraso",type:"integer"},{name:"consideracion_retraso_descripcion",type:"numeric"},{name:"fecha_ini",type:"date",formatstring:"dd-mm-yyyy"},{name:"fecha_fin",type:"date"},{name:"descripcion",type:"string"},{name:"observacion",type:"string"},{name:"estado",type:"string"},{name:"estado_descripcion",type:"string"}],url:"/tolerancias/list",cache:!1});!function(){var e=prepareSimulator("grid");$("#jqxgridtolerancias").jqxGrid({theme:e,width:"100%",height:"450px",source:a,sortable:!0,altRows:!0,groupable:!0,columnsresize:!0,pageable:!0,pagerMode:"advanced",showfilterrow:!0,filterable:!0,showtoolbar:!0,autorowheight:!0,enablebrowserselection:!0,rendertoolbar:function(e){var a=$("<div></div>");e.append(a),a.append("<button id='addrowbutton' class='btn btn-sm btn-primary' type='button'><i class='fa fa-plus-square fa-2x text-info' title='Nuevo Registro.'/></i></button>"),a.append("<button id='approverowbutton'  class='btn btn-sm btn-primary' type='button' ><i class='fa fa-check-square fa-2x text-primary' title='Aprobar registro'></i></button>"),a.append("<button id='updaterowbutton'  class='btn btn-sm btn-primary' type='button' ><i class='fa fa-pencil-square fa-2x text-success' title='Modificar registro.'/></button>"),a.append("<button id='deleterowbutton' class='btn btn-sm btn-primary' type='button'><i class='fa fa-minus-square fa-2x text-danger' title='Dar de baja al registro.'/></i></button>"),a.append("<button title='Refrescar Grilla' id='refreshbutton' class='btn btn-sm btn-primary' type='button'><i class='fa fa-repeat fa-2x text-default' title='Refrescar grilla.'/></i></button>"),a.append("<button title='Desagrupar.' id='cleargroupsrowbutton' class='btn btn-sm btn-primary' type='button'><i class='fa fa-chain-broken fa-2x text-default' title='Desagrupar.'/></i></button>"),a.append("<button title='Desfiltrar.' id='clearfiltersrowbutton' class='btn btn-sm btn-primary' type='button'><i class='gi gi-sorting fa-2x text-default' title='Desfiltrar.'/></i></button>"),$("#addrowbutton").jqxButton(),$("#approverowbutton").jqxButton(),$("#updaterowbutton").jqxButton(),$("#deleterowbutton").jqxButton(),$("#refreshbutton").jqxButton(),$("#cleargroupsrowbutton").jqxButton(),$("#clearfiltersrowbutton").jqxButton(),$("#refreshbutton").off(),$("#refreshbutton").on("click",function(){$("#jqxgridtolerancias").jqxGrid("updatebounddata")}),$("#cleargroupsrowbutton").off(),$("#cleargroupsrowbutton").on("click",function(){$("#jqxgridtolerancias").jqxGrid("cleargroups")}),$("#clearfiltersrowbutton").off(),$("#clearfiltersrowbutton").on("click",function(){$("#jqxgridtolerancias").jqxGrid("clearfilters")}),$("#addrowbutton").on("click",function(){$("#jqxTabsTolerancias").jqxTabs("enableAt",1),$("#jqxTabsTolerancias").jqxTabs("disableAt",2),$("#jqxTabsTolerancias").jqxTabs("disableAt",3),$("#jqxTabsTolerancias").jqxTabs({selectedItem:1}),inicializarCamposParaNuevoRegistroTolerancia(),limpiarMensajesErrorPorValidacionTolerancia(""),cargarTiposDeAcumulacion(-1,""),cargarOpcionesDeConsideracionEnRetraso(-1,""),$("#txtTolerancia").focus()}),$("#approverowbutton").on("click",function(){var e=$("#jqxgridtolerancias").jqxGrid("getselectedrowindex");if(0<=e){var a=$("#jqxgridtolerancias").jqxGrid("getrowdata",e);if(null!=a)if(2==a.estado)confirm("¿Esta seguro de aprobar este registro de tolerancia?")&&aprobarRegistroTolerancia(a.id);else{var i="Debe seleccionar un registro con estado EN PROCESO para posibilitar la aprobaci&oacute;n del registro";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}else{var i="Debe seleccionar un registro necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(i),$("#divMsjeNotificacionError").jqxNotification("open")}}),$("#updaterowbutton").on("click",function(){var e=$("#jqxgridtolerancias").jqxGrid("getselectedrowindex");if(0<=e){var a=$("#jqxgridtolerancias").jqxGrid("getrowdata",e);if(null!=a)if($("#hdnIdToleranciaEditar").val(a.id),1<=a.estado){$("#jqxTabsTolerancias").jqxTabs("enableAt",0),$("#jqxTabsTolerancias").jqxTabs("disableAt",1),$("#jqxTabsTolerancias").jqxTabs("enableAt",2),$("#jqxTabsTolerancias").jqxTabs("disableAt",3),$("#jqxTabsTolerancias").jqxTabs({selectedItem:2}),limpiarMensajesErrorPorValidacionTolerancia("Editar"),$("#txtToleranciaEditar").val(a.tolerancia),cargarTiposDeAcumulacion(a.tipo_acumulacion,"Editar"),cargarOpcionesDeConsideracionEnRetraso(a.consideracion_retraso,"Editar"),$("#txtDescripcionEditar").val(a.descripcion);var i="";null!=a.fecha_ini&&(i=$.jqx.dataFormat.formatdate(a.fecha_ini,"dd-MM-yyyy"));var t="";null!=a.fecha_fin&&(t=$.jqx.dataFormat.formatdate(a.fecha_fin,"dd-MM-yyyy")),$("#txtFechaIniEditar").val(i),$("#txtFechaFinEditar").val(t),$("#txtObservacionEditar").val(a.observacion),$("#txtToleranciaEditar").focus()}else{var r="Debe seleccionar un registro en estado EN PROCESO o ACTIVO necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(r),$("#divMsjeNotificacionError").jqxNotification("open")}}else{var r="Debe seleccionar un registro necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(r),$("#divMsjeNotificacionError").jqxNotification("open")}}),$("#deleterowbutton").on("click",function(){var e=$("#jqxgridtolerancias").jqxGrid("getselectedrowindex");if(0<=e){var a=$("#jqxgridtolerancias").jqxGrid("getrowdata",e);if(null!=a){var i=a.id;if(1<=a.estado)confirm("Esta seguro de dar de baja registro de tolerancia?")&&darDeBajaTolerancia(i);else{var t="Para dar de baja un registro, este debe estar en estado ACTIVO o EN PROCESO inicialmente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(t),$("#divMsjeNotificacionError").jqxNotification("open")}}}else{var t="Debe seleccionar un registro necesariamente.";$("#divMsjePorError").html(""),$("#divMsjePorError").append(t),$("#divMsjeNotificacionError").jqxNotification("open")}})},columns:[{text:"Nro.",filterable:!1,columntype:"number",width:40,cellsalign:"center",align:"center",cellsrenderer:rownumberrenderer},{text:"Estado",filtertype:"checkedlist",datafield:"estado_descripcion",width:90,cellsalign:"center",align:"center",hidden:!1,cellclassname:cellclass},{text:"Tolerancia",filtertype:"checkedlist",datafield:"tolerancia",width:100,cellsalign:"center",align:"center",hidden:!1},{text:"Acumulaci&oacute;n",filtertype:"checkedlist",datafield:"acumulacion_descripcion",width:100,align:"center",cellsalign:"center",hidden:!1},{text:"Consideraci&oacute;n",filtertype:"checkedlist",datafield:"consideracion_retraso_descripcion",width:100,align:"center",hidden:!1},{text:"Descripci&oacute;n",filtertype:"checkedlist",datafield:"descripcion",width:400,align:"center",hidden:!1},{text:"Fecha Inicio",datafield:"fecha_ini",filtertype:"range",width:200,cellsalign:"center",cellsformat:"dd-MM-yyyy",align:"center",hidden:!1},{text:"Fecha Fin",datafield:"fecha_fin",filtertype:"range",width:100,cellsalign:"center",cellsformat:"dd-MM-yyyy",align:"center",hidden:!0},{text:"Observaci&oacute;n",filtertype:"checkedlist",datafield:"observacion",width:100,align:"center",hidden:!1}]});$("#jqxlistbox").jqxListBox({source:[{label:"Estado",value:"estado_descripcion",checked:!0},{label:"Tolerancia",value:"tolerancia",checked:!0},{label:"Acumulaci&oacute;n",value:"acumulacion_descripcion",checked:!0},{label:"Consideraci&oacute;n",value:"consideracion_retraso_descripcion",checked:!0},{label:"Descripci&oacute;n",value:"descripcion",checked:!0},{label:"Fecha Ini",value:"fecha_ini",checked:!0},{label:"Fecha Fin",value:"fecha_fin",checked:!1},{label:"Observaci&oacute;n",value:"observacion",checked:!0}],width:"100%",height:430,checkboxes:!0}),$("#jqxlistbox").on("checkChange",function(e){$("#jqxgridtolerancias").jqxGrid("beginupdate"),e.args.checked?$("#jqxgridtolerancias").jqxGrid("showcolumn",e.args.value):$("#jqxgridtolerancias").jqxGrid("hidecolumn",e.args.value),$("#jqxgridtolerancias").jqxGrid("endupdate")})}()}$().ready(function(){$("#jqxTabsTolerancias").jqxTabs("theme","oasis"),$("#jqxTabsTolerancias").jqxTabs("enableAt",0),$("#jqxTabsTolerancias").jqxTabs("disableAt",1),$("#jqxTabsTolerancias").jqxTabs("disableAt",2),$("#jqxTabsTolerancias").jqxTabs("disableAt",3),definirGrillaParaListaTolerancias(),$("#btnGuardarToleranciaNuevo").click(function(){validaFormularioTolerancia()&&(guardaTolerancia()&&($("#jqxTabsTolerancias").jqxTabs("enableAt",0),$("#jqxTabsTolerancias").jqxTabs("disableAt",1),$("#jqxTabsTolerancias").jqxTabs("disableAt",2),$("#jqxTabsTolerancias").jqxTabs("disableAt",3),$("#msjs-alert").hide()))}),$("#btnGuardarToleranciaEditar").click(function(){validaFormularioTolerancia()&&(guardaTolerancia()&&($("#jqxTabsTolerancias").jqxTabs("enableAt",0),$("#jqxTabsTolerancias").jqxTabs("disableAt",1),$("#jqxTabsTolerancias").jqxTabs("disableAt",2),$("#jqxTabsTolerancias").jqxTabs("disableAt",3),$("#msjs-alert").hide()))}),$("#btnCancelarToleranciaNuevo").click(function(){$("#jqxTabsTolerancias").jqxTabs("enableAt",0),$("#jqxTabsTolerancias").jqxTabs("disableAt",1),$("#jqxTabsTolerancias").jqxTabs("disableAt",2),$("#jqxTabsTolerancias").jqxTabs("disableAt",3),$("#msjs-alert").hide()}),$("#btnCancelarToleranciaEditar").click(function(){$("#jqxTabsTolerancias").jqxTabs("enableAt",0),$("#jqxTabsTolerancias").jqxTabs("disableAt",1),$("#jqxTabsTolerancias").jqxTabs("disableAt",2),$("#jqxTabsTolerancias").jqxTabs("disableAt",3),$("#msjs-alert").hide()}),$("#btnExportarExcel").click(function(){var e=$("#jqxlistbox").jqxListBox("getCheckedItems"),i=0;$.each(e,function(e,a){i++}),0<i?exportarReporte(1):(alert("Debe seleccionar al menos una columna para la obtención del reporte solicitado."),$("#jqxlistbox").focus())}),$("#btnExportarPDF").click(function(){var e=$("#jqxlistbox").jqxListBox("getCheckedItems"),i=0;$.each(e,function(e,a){i++}),0<i?exportarReporte(2):(alert("Debe seleccionar al menos una columna para la obtención del reporte solicitado."),$("#jqxlistbox").focus())}),$("#chkAllCols").click(function(){1==this.checked?$("#jqxlistbox").jqxListBox("checkAll"):$("#jqxlistbox").jqxListBox("uncheckAll")}),$("#liList").click(function(){$("#btnCancelarToleranciaNuevo").click(),$("#btnCancelarToleranciaEditar").click()}),$("#btnDesfiltrartodo").click(function(){$("#jqxgridtolerancias").jqxGrid("clearfilters")}),$("#btnDesagrupartodo").click(function(){$("#jqxgridtolerancias").jqxGrid("cleargroups")}),$("#btnDesagruparTodoMovilidad").click(function(){$("#jqxgridtoleranciasmovilidad").jqxGrid("cleargroups")}),$(".numeral").keyup(function(e){""!=$(this).val()&&$(this).val($(this).val().replace(/[^0-9]/g,""))}),$(".literal").keyup(function(e){""!=$(this).val()&&$(this).val($(this).val().replace(/[^A-Z,a-z,ñ,Ñ, ]/g,""))}),$("#divMsjeNotificacionError").jqxNotification({width:"100%",position:"bottom-right",opacity:.9,autoOpen:!1,animationOpenDelay:800,autoClose:!0,autoCloseDelay:7e3,template:"error"}),$("#divMsjeNotificacionWarning").jqxNotification({width:"100%",position:"bottom-right",opacity:.9,autoOpen:!1,animationOpenDelay:800,autoClose:!0,autoCloseDelay:7e3,template:"warning"}),$("#divMsjeNotificacionSuccess").jqxNotification({width:"100%",position:"bottom-right",opacity:.9,autoOpen:!1,animationOpenDelay:800,autoClose:!0,autoCloseDelay:7e3,template:"success"}),$(document).keypress(OperaEvento),$(document).keyup(OperaEvento)});var rownumberrenderer=function(e,a,i,t,r,o){return"<div align='center'>"+(e+1)+"</div>"};function OperaEvento(e){"keyup"!=e.type&&"keydown"!=e.type||"27"!=e.which||($("#jqxTabsTolerancias").jqxTabs("enableAt",0),$("#jqxTabsTolerancias").jqxTabs("disableAt",1),$("#jqxTabsTolerancias").jqxTabs("disableAt",2),$("#jqxTabsTolerancias").jqxTabs("disableAt",3),$("#jqxTabsTolerancias").jqxTabs({selectedItem:0}))}var cellclass=function(e,a,i){return"ACTIVO"==i?"verde":"EN PROCESO"==i?"amarillo":"PASIVO"==i?"rojo":""};